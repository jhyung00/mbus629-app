<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mastering Financial Analysis: From Transaction to Transformation</title>
    <!-- Fonts: Swapped to playful, modern, rounded fonts -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@600;700;800&family=Nunito:wght@400;600;700&family=Fira+Code:wght@400;600&display=swap" rel="stylesheet">
    
    <style>
        :root {
            /* FUN VIBRANT COLOR PALETTE */
            --bg-color: #f8fafc; /* Very light cool gray/blue */
            --text-color: #334155;
            --accent-blue: #8b5cf6; /* Vibrant Indigo */
            --accent-light: #c4b5fd;
            --success: #10b981; /* Bouncy Mint Green */
            --error: #f43f5e; /* Vibrant Coral/Pink */
            --warning: #f59e0b; /* Bright Orange */
            --card-bg: #ffffff;
            --shadow: 0 10px 25px -5px rgba(139, 92, 246, 0.15); /* Tinted purple shadow */
            --shadow-lg: 0 20px 40px -10px rgba(139, 92, 246, 0.25);
            --header-font: 'Poppins', sans-serif;
            --body-font: 'Nunito', sans-serif;
            --gradient-primary: linear-gradient(135deg, #6366f1 0%, #a855f7 100%);
            --gradient-fun: linear-gradient(135deg, #f43f5e 0%, #f97316 100%);
            --radius-lg: 20px;
            --radius-md: 12px;
            --radius-pill: 50px;
            --bounce: cubic-bezier(0.34, 1.56, 0.64, 1); /* Springy animation */
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }

        body {
            font-family: var(--body-font);
            background-color: #e0e7ff; /* Soft violet background */
            background-image: radial-gradient(circle at 10% 20%, rgba(167, 139, 250, 0.1) 0%, transparent 20%), 
                              radial-gradient(circle at 90% 80%, rgba(244, 63, 94, 0.1) 0%, transparent 20%);
            color: var(--text-color);
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden;
        }

        /* --- Main Layout --- */
        #app-container {
            width: 100%;
            max-width: 1400px;
            height: 90vh;
            background-color: var(--bg-color);
            position: relative;
            box-shadow: var(--shadow-lg);
            border-radius: var(--radius-lg);
            overflow: hidden;
            display: flex;
            flex-direction: column;
            border: 4px solid rgba(255,255,255,0.5);
        }

        .slide {
            display: none;
            flex: 1;
            padding: 3rem 4rem;
            overflow-y: auto;
            flex-direction: column;
            animation: bounceIn 0.6s var(--bounce);
        }

        .slide.active { display: flex; }

        @keyframes bounceIn {
            0% { opacity: 0; transform: translateY(30px) scale(0.98); }
            100% { opacity: 1; transform: translateY(0) scale(1); }
        }

        /* --- Typography & Utils --- */
        h1, h2, h3, h4 { 
            font-family: var(--header-font); 
            color: #1e293b; 
            margin-bottom: 1rem; 
            letter-spacing: -0.5px;
        }
        
        /* Gradient Main Header */
        h1 { 
            font-size: 3.5rem; 
            background: var(--gradient-primary);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 1.5rem;
            line-height: 1.2;
        }
        
        h2 { 
            font-size: 2.4rem; 
            border-bottom: 4px solid var(--accent-light); 
            padding-bottom: 10px; 
            display: inline-block; 
            border-radius: 2px;
        }
        
        p, li { 
            font-size: 1.2rem; 
            line-height: 1.7; 
            color: #475569; 
            margin-bottom: 1rem; 
        }
        
        .text-accent { color: var(--accent-blue); font-weight: 700; }
        .text-error { color: var(--error); font-weight: 700; }
        .text-success { color: var(--success); font-weight: 700; }
        .text-center { text-align: center; }
        .flex-center { display: flex; justify-content: center; align-items: center; height: 100%; }
        .mt-4 { margin-top: 2rem; }
        .mb-4 { margin-bottom: 2rem; }

        /* --- Grid Layouts --- */
        .grid-2 { display: grid; grid-template-columns: 1fr 1fr; gap: 3rem; align-items: start; }
        .grid-2-wide { display: grid; grid-template-columns: 1fr 1fr; gap: 4rem; align-items: start; }
        .grid-3 { display: grid; grid-template-columns: repeat(3, 1fr); gap: 2rem; }

        /* --- Components --- */
        .card {
            background: var(--card-bg);
            padding: 2rem;
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow);
            border: 2px solid transparent;
            transition: all 0.3s var(--bounce);
            height: 100%; 
            position: relative;
            overflow: hidden;
        }
        .card:hover { 
            transform: translateY(-8px) rotate(-1deg); 
            border-color: var(--accent-light);
            box-shadow: var(--shadow-lg);
        }
        .card-highlight { border-left: 6px solid var(--accent-blue); background: #f5f3ff; }
        .card-success { border-left: 6px solid var(--success); background-color: #ecfdf5; }
        .card-warn { border-left: 6px solid var(--warning); background-color: #fffbeb; }

        /* --- Tables --- */
        .financial-table {
            width: 100%;
            border-collapse: separate;
            border-spacing: 0;
            font-family: 'Fira Code', monospace;
            font-size: 1rem;
            background: white;
            border: 2px solid #e2e8f0;
            border-radius: var(--radius-md);
            overflow: hidden;
            box-shadow: var(--shadow);
        }
        .financial-table th, .financial-table td {
            padding: 12px 15px;
            border-bottom: 1px solid #e2e8f0;
            text-align: right;
        }
        .financial-table th { 
            text-align: left; 
            background: var(--gradient-primary); 
            color: white;
            font-family: var(--header-font);
            font-size: 1.1rem;
        }
        .financial-table td:first-child { text-align: left; font-family: var(--body-font); font-weight: 600; color: #334155;}
        .financial-table tr:last-child td { border-bottom: none; }
        .financial-table tr.total-row { font-weight: bold; background-color: #f1f5f9; border-top: 2px solid #cbd5e1; }

        /* --- Timeline Visual --- */
        .timeline-container {
            position: relative;
            padding: 30px 0 80px 0; 
            margin: 20px 0;
        }
        .timeline-line {
            height: 8px;
            background: #cbd5e1;
            position: relative;
            width: 100%;
            top: 10px;
            border-radius: 4px;
        }
        .timeline-point {
            width: 24px;
            height: 24px;
            background: var(--gradient-primary);
            border-radius: 50%;
            position: absolute;
            top: 2px;
            z-index: 2;
            box-shadow: 0 0 0 4px white;
        }
        .timeline-label {
            position: absolute;
            top: 45px;
            transform: translateX(-50%);
            text-align: center;
            font-weight: 700;
            font-size: 0.9rem;
            width: auto;
            max-width: 150px;
            white-space: normal;
            line-height: 1.3;
            background: white;
            padding: 8px 12px;
            border-radius: var(--radius-md);
            box-shadow: var(--shadow);
            border: 2px solid #f1f5f9;
            z-index: 1;
            color: var(--accent-blue);
        }
        .time-arrow {
            position: absolute;
            right: -15px;
            top: 2px;
            color: #94a3b8;
        }

        /* --- FSET Table Simulator --- */
        .fset-container {
            background: white;
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow);
            padding: 1.5rem;
            width: 100%;
            position: relative;
            border: 2px solid #e2e8f0;
        }
        
        .fset-reset-btn {
            background: var(--error);
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: var(--radius-pill);
            cursor: pointer;
            font-size: 0.9rem;
            font-weight: bold;
            margin-bottom: 15px;
            display: inline-block;
            transition: all 0.2s;
            box-shadow: 0 4px 10px rgba(244, 63, 94, 0.3);
        }
        .fset-reset-btn:hover {
            transform: scale(1.05);
        }
        
        .fset-table {
            width: 100%;
            border-collapse: separate;
            border-spacing: 0;
            text-align: center;
            table-layout: fixed;
            border-radius: var(--radius-md);
            overflow: hidden;
            border: 2px solid #e2e8f0;
        }
        .fset-table th {
            background: #334155;
            color: white;
            padding: 8px 4px;
            font-size: 0.8rem;
            white-space: normal;
            word-wrap: break-word;
            line-height: 1.2;
            font-family: var(--header-font);
        }
        .fset-table td {
            padding: 8px 2px;
            border-bottom: 1px solid #e2e8f0;
            border-right: 1px solid #e2e8f0;
            background: #f8fafc;
        }
        .fset-control {
            display: flex;
            flex-direction: column;
            gap: 4px;
            align-items: center;
        }
        .fset-btn {
            background: white;
            border: 2px solid #cbd5e1;
            border-radius: 50%;
            width: 28px;
            height: 28px;
            cursor: pointer;
            transition: all 0.2s var(--bounce);
            font-size: 0.7rem;
            padding: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #64748b;
        }
        .fset-btn:hover { 
            border-color: var(--accent-blue); 
            color: var(--accent-blue);
            transform: scale(1.1);
        }
        .fset-btn.selected-up { background: var(--success); color: white; border-color: var(--success); transform: scale(1.15); box-shadow: 0 2px 8px rgba(16, 185, 129, 0.4);}
        .fset-btn.selected-down { background: var(--error); color: white; border-color: var(--error); transform: scale(1.15); box-shadow: 0 2px 8px rgba(244, 63, 94, 0.4);}
        
        /* Column Width Utilities for FSET */
        .col-sign { width: 3%; font-weight: 900; color: #94a3b8; font-size: 1.2rem; }
        .col-data { width: 10%; }

        .account-selector-container {
            display: flex;
            gap: 1rem;
            justify-content: center;
            flex-wrap: wrap;
        }
        .account-selector {
            margin-top: 15px;
            padding: 12px;
            width: 100%;
            max-width: 300px;
            border: 2px solid #cbd5e1;
            border-radius: var(--radius-md);
            font-size: 1rem;
            font-family: var(--body-font);
            font-weight: 600;
            color: #334155;
            transition: border-color 0.2s;
            cursor: pointer;
        }
        .account-selector:focus {
            outline: none;
            border-color: var(--accent-blue);
        }

        /* --- Calculator UI --- */
        .calc-ui {
            background: #1e293b;
            padding: 20px;
            border-radius: 24px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.4);
            max-width: 320px;
            margin: 0 auto;
            color: white;
            border: 4px solid #334155;
        }
        .calc-screen {
            background: #f1f5f9;
            color: #0f172a;
            font-family: 'Fira Code', monospace;
            padding: 15px;
            text-align: right;
            border-radius: 12px;
            margin-bottom: 15px;
            font-size: 1.4rem;
            font-weight: 700;
            height: 55px;
            display: flex;
            align-items: center;
            justify-content: flex-end;
            box-shadow: inset 0 2px 4px rgba(0,0,0,0.1);
        }
        .calc-input-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            padding: 8px 12px;
            border-radius: 8px;
            transition: background 0.2s;
            background: rgba(255,255,255,0.05);
        }
        .calc-input-row:hover { background: rgba(255,255,255,0.15); transform: translateX(2px); }
        .calc-input-row:active { background: rgba(255,255,255,0.25); }

        /* --- Flip Cards --- */
        .flip-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 2rem; perspective: 1000px; }
        .flip-card { background-color: transparent; height: 260px; perspective: 1000px; cursor: pointer; }
        .flip-inner { position: relative; width: 100%; height: 100%; text-align: center; transition: transform 0.6s var(--bounce); transform-style: preserve-3d; border-radius: var(--radius-lg); box-shadow: var(--shadow);}
        .flip-card:hover .flip-inner { box-shadow: var(--shadow-lg); }
        .flip-card.flipped .flip-inner { transform: rotateY(180deg); }
        .flip-front, .flip-back { position: absolute; width: 100%; height: 100%; backface-visibility: hidden; display: flex; flex-direction: column; justify-content: center; align-items: center; padding: 2rem; border-radius: var(--radius-lg); }
        .flip-front { background: var(--gradient-primary); color: white; }
        .flip-back { background: white; color: var(--text-color); transform: rotateY(180deg); border: 3px solid var(--accent-light); }

        /* Small Hint Flip Card */
        .flip-hint {
            background-color: transparent;
            height: 60px;
            width: 250px;
            perspective: 1000px;
            cursor: pointer;
            margin: 15px auto;
        }
        .flip-hint .flip-inner { box-shadow: none; border-radius: var(--radius-pill); }
        .flip-hint.flipped .flip-inner { transform: rotateY(180deg); }
        .flip-hint .flip-front, .flip-hint .flip-back { padding: 0.5rem 1rem; border: none; border-radius: var(--radius-pill); font-size: 1rem; font-weight: 700; }
        .flip-hint .flip-front { background: #e2e8f0; color: #475569; border: 2px dashed #cbd5e1; }
        .flip-hint .flip-back { background: var(--gradient-fun); color: white; transform: rotateY(180deg); box-shadow: var(--shadow);}

        /* --- T-Accounts Animation --- */
        .t-account-grid { display: grid; grid-template-columns: 1fr 1.5fr 1fr; gap: 1.5rem; margin-top: 1rem; align-items: start; }
        .t-account-wrapper { background: white; padding: 15px; border-radius: var(--radius-lg); box-shadow: var(--shadow); border: 2px solid #e2e8f0;}
        .main-account { border: 3px solid var(--accent-blue); background: #f5f3ff; transform: scale(1.05); }
        .t-account-visual { display: flex; border-top: 3px solid #334155; margin-top: 10px; }
        .t-left { flex: 1; border-right: 3px solid #334155; padding: 10px; text-align: right; min-height: 80px; font-size: 1rem; color: var(--error); font-weight: bold;}
        .t-right { flex: 1; padding: 10px; text-align: left; min-height: 80px; font-size: 1rem; color: var(--success); font-weight: bold;}

        /* --- Interactive Elements --- */
        .btn-action {
            background: var(--gradient-primary);
            color: white;
            border: none;
            padding: 12px 28px;
            border-radius: var(--radius-pill);
            cursor: pointer;
            font-size: 1.1rem;
            font-weight: 700;
            margin-top: 10px;
            box-shadow: 0 4px 15px rgba(99, 102, 241, 0.4);
            transition: all 0.3s var(--bounce);
        }
        .btn-action:hover { 
            transform: translateY(-3px) scale(1.05);
            box-shadow: 0 8px 20px rgba(99, 102, 241, 0.6);
        }
        .btn-action:disabled { background: #cbd5e1; box-shadow: none; transform: none; cursor: not-allowed; }
        .feedback-msg { min-height: 1.5rem; font-weight: bold; margin-top: 1rem; text-align: center; font-size: 1.1rem; }

        /* --- Navigation --- */
        #nav-bar {
            background: rgba(255, 255, 255, 0.85);
            backdrop-filter: blur(12px);
            border-top: 1px solid rgba(255,255,255,0.4);
            padding: 1rem 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .progress-bar-container { flex: 1; height: 12px; background: #e2e8f0; margin: 0 30px; border-radius: 10px; overflow: hidden; }
        #progress-fill { height: 100%; background: var(--gradient-fun); width: 0%; border-radius: 10px; transition: width 0.5s var(--bounce); }
        
        /* Navigation Table of Contents Style */
        #toc {
            padding: 8px 15px;
            border-radius: var(--radius-pill);
            background: #f1f5f9;
            color: var(--text-color);
            border: 2px solid #cbd5e1;
            cursor: pointer;
            max-width: 250px;
            font-family: var(--body-font);
            font-weight: 700;
            font-size: 0.95rem;
            margin-right: 15px;
            transition: all 0.2s;
        }
        #toc:focus, #toc:hover {
            outline: none;
            border-color: var(--accent-blue);
            background: white;
            box-shadow: 0 0 0 3px rgba(139, 92, 246, 0.2);
        }
        #toc option { background: #ffffff; color: var(--text-color); }
        
        .nav-arrow-btn {
            background: white;
            color: var(--accent-blue);
            border: 2px solid var(--accent-blue);
            border-radius: 50%;
            width: 40px;
            height: 40px;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            transition: all 0.2s var(--bounce);
        }
        .nav-arrow-btn:hover {
            background: var(--accent-blue);
            color: white;
            transform: scale(1.1);
        }

        /* --- Final Exam --- */
        .quiz-question { margin-bottom: 2rem; border-bottom: 2px dashed #e2e8f0; padding-bottom: 2rem; }
        .quiz-question p { font-family: var(--header-font); font-size: 1.3rem; font-weight: 600; color: #1e293b;}
        .quiz-option { 
            display: block; padding: 12px 20px; margin: 10px 0; background: white; 
            border: 2px solid #e2e8f0; border-radius: var(--radius-md); cursor: pointer; transition: all 0.2s; 
            font-weight: 600;
        }
        .quiz-option:hover { background: #f8fafc; border-color: var(--accent-light); transform: translateX(5px); }
        .quiz-option.selected { background: #f5f3ff; border-color: var(--accent-blue); font-weight: bold; transform: scale(1.02); box-shadow: var(--shadow); }

        /* Icon Circles */
        .icon-circle {
            display: inline-flex;
            justify-content: center;
            align-items: center;
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: #f1f5f9;
            margin-bottom: 15px;
        }

        /* Input styling */
        input[type="number"] {
            border: 2px solid #cbd5e1;
            border-radius: 8px;
            font-family: var(--body-font);
            font-weight: bold;
            color: var(--text-color);
            transition: border-color 0.2s;
        }
        input[type="number"]:focus {
            outline: none;
            border-color: var(--accent-blue);
        }
        
        /* Drag and Drop styling */
        .draggable {
            background: white !important;
            border: 2px solid #cbd5e1 !important;
            border-radius: var(--radius-md) !important;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
            font-weight: 700;
            color: #334155 !important;
            transition: transform 0.2s;
        }
        .draggable:hover { transform: scale(1.02); border-color: var(--accent-light) !important;}
        .dropzone {
            background: white;
            border: 3px dashed #cbd5e1 !important;
            border-radius: var(--radius-lg) !important;
            transition: all 0.2s;
        }
        .dropzone h5 { font-family: var(--header-font); font-size: 1.2rem; color: #64748b; margin-bottom: 10px;}
        
    </style>
</head>
<body>

<div id="app-container">

    <!-- INTRO -->
    <div class="slide active" id="slide-1">
        <div class="flex-center" style="flex-direction: column; text-align: center;">
            <div class="icon-circle" style="background: #e0e7ff; width: 120px; height: 120px;">
                <i class="fas fa-chart-line fa-4x text-accent"></i>
            </div>
            <h1>From Transaction to Transformation</h1>
            <h3 style="color: #64748b; font-weight: 600;">The Complete Financial Analysis Course</h3>
            <p class="mt-4" style="font-weight: bold; background: #f1f5f9; padding: 10px 20px; border-radius: 50px;">Interactive Drills | FSET Simulation | Final Exam</p>
            <button class="btn-action mt-4" style="font-size: 1.3rem; padding: 15px 40px;" onclick="nextSlide()">Begin Course <i class="fas fa-rocket" style="margin-left: 8px;"></i></button>
        </div>
    </div>

    <!-- ACT 1: INCOME STATEMENT -->
    <div class="slide" id="slide-2">
        <h2>Act 1: The Income Statement</h2>
        <div class="grid-2">
            <div>
                <div class="card card-highlight">
                    <p><strong>Definition:</strong> Reports revenues earned, expenses incurred, and resulting net income over a period of time.</p>
                </div>
                <p class="mt-4" style="font-weight: bold;">It is the video recording of the company's profitability.</p>
                <ul style="list-style: none;">
                    <li><i class="fas fa-play-circle text-accent" style="margin-right: 10px;"></i> <strong>Top Line:</strong> Net Sales</li>
                    <li><i class="fas fa-pause-circle text-accent" style="margin-right: 10px;"></i> <strong>Middle:</strong> Expenses (COGS, OpEx)</li>
                    <li><i class="fas fa-stop-circle text-accent" style="margin-right: 10px;"></i> <strong>Bottom Line:</strong> Net Income</li>
                </ul>
            </div>
            <div>
                <!-- APPLE INCOME STATEMENT -->
                <table class="financial-table">
                    <tr><th colspan="2">Apple Inc. - Income Statement (2022)</th></tr>
                    <tr><td>Net Sales</td><td>$394,328</td></tr>
                    <tr><td>Cost of Sales</td><td>(223,546)</td></tr>
                    <tr class="total-row"><td>Gross Margin</td><td>170,782</td></tr>
                    <tr><td>Operating Expenses</td><td>(51,345)</td></tr>
                    <tr class="total-row"><td>Operating Income</td><td>119,437</td></tr>
                    <tr><td>Other / Tax</td><td>(19,634)</td></tr>
                    <tr class="total-row" style="background:#ecfdf5; color: #047857; font-size: 1.1rem;"><td>Net Income</td><td>$99,803</td></tr>
                </table>
            </div>
        </div>
    </div>

    <div class="slide" id="slide-3">
        <h2>Case Study: Apple Inc.</h2>
        <p>We will use Apple's fiscal year 2022 data for our analysis.</p>
        <div class="fset-container text-center" style="margin-top: 40px; padding: 4rem 2rem;">
            <div class="icon-circle" style="background: #fef3c7; margin: 0 auto 20px auto;">
                <i class="fas fa-apple-alt fa-2x" style="color: #d97706;"></i>
            </div>
            <h1 class="text-accent" style="font-size: 4.5rem; background: var(--gradient-fun); -webkit-background-clip: text;">$394,328 Million</h1>
            <p style="font-size: 1.5rem; font-weight: 800; color: #1e293b;">Net Sales (Revenue)</p>
            <p class="mt-4" style="max-width: 600px; margin: 2rem auto 0 auto;">This represents the total value of iPhones, Macs, and Services sold to customers.</p>
        </div>
    </div>

    <div class="slide" id="slide-4">
        <h2>Cost of Goods Sold (COGS)</h2>
        <div class="grid-2">
            <div>
                <p>Direct costs to produce the goods sold.</p>
                <div class="card" style="padding: 1.5rem;">
                    <h3 style="margin: 0; font-size: 1.2rem;">Revenue</h3>
                    <p class="text-accent" style="font-size: 2rem; font-weight: 800; margin:0;">$394,328</p>
                </div>
                <div class="card mt-4" style="padding: 1.5rem; border-color: var(--error);">
                    <h3 style="margin: 0; font-size: 1.2rem;">COGS</h3>
                    <p class="text-error" style="font-size: 2rem; font-weight: 800; margin:0;">$223,546</p>
                </div>
            </div>
            
            <div class="flip-card" onclick="this.classList.toggle('flipped')" style="height: 300px;">
                <div class="flip-inner">
                    <div class="flip-front">
                        <div class="icon-circle" style="background: rgba(255,255,255,0.2);">
                            <i class="fas fa-boxes fa-2x"></i>
                        </div>
                        <h3>What are Direct Costs?</h3>
                        <p style="color:white; margin-top:10px; font-weight: 600;">Click to reveal examples.</p>
                    </div>
                    <div class="flip-back">
                        <h3 style="color: var(--accent-blue);">Direct Costs Include:</h3>
                        <ul style="text-align: left; padding-left: 20px; margin-top: 20px;">
                            <li><strong>Materials:</strong> Screens, Chips, Aluminum.</li>
                            <li><strong>Direct Labor:</strong> Assembly line wages.</li>
                            <li><strong>Mfg Overhead:</strong> Factory rent/power.</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Interactive Gross Margin -->
    <div class="slide" id="slide-5">
        <h2>Gross Margin Analysis</h2>
        <div class="grid-2">
            <div class="card text-center flex-center" style="flex-direction: column; min-height: 350px;">
                <p style="font-weight: 700; font-size: 1.3rem;">Calculate Apple's Gross Margin.</p>
                <div style="display: flex; gap: 15px; justify-content: center; margin: 20px 0; align-items: center;">
                    <input type="number" id="gm-rev" value="394328" placeholder="Rev" style="width: 140px; padding: 12px; font-size: 1.2rem; text-align: center;">
                    <span style="font-size: 2rem; font-weight: bold; color: #94a3b8;">-</span>
                    <input type="number" id="gm-cogs" value="223546" placeholder="COGS" style="width: 140px; padding: 12px; font-size: 1.2rem; text-align: center;">
                </div>
                <button class="btn-action" onclick="calcGrossMargin()">Calculate</button>
                <div id="gm-result" class="mt-4" style="font-weight: 800; font-size: 2rem; background: #f1f5f9; padding: 10px 20px; border-radius: 12px; display: inline-block;"></div>
            </div>
            
            <div class="flip-card" onclick="this.classList.toggle('flipped')" style="height: 350px;">
                <div class="flip-inner">
                    <div class="flip-front" style="background: var(--gradient-fun);">
                        <div class="icon-circle" style="background: rgba(255,255,255,0.2);">
                            <i class="fas fa-lightbulb fa-2x"></i>
                        </div>
                        <h3>Interpretation</h3>
                        <p style="color:white; margin-top:10px; font-weight: 600;">Click to reveal what this 43.3% means.</p>
                    </div>
                    <div class="flip-back" style="border-color: var(--error);">
                        <h3 style="color: var(--error);">Pricing Power</h3>
                        <p style="font-weight: 600;">A 43% Gross Margin is exceptionally high for hardware.</p>
                        <p>It means Apple commands a premium price and keeps 43 cents of every dollar purely for manufacturing markup, before paying for R&D or Marketing.</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- ACT 2: ACCRUAL ACCOUNTING -->
    <div class="slide" id="slide-6">
        <h2>Act 2: Accrual Accounting</h2>
        <div class="grid-2">
            <div class="card card-highlight">
                <div class="icon-circle" style="background: #e0e7ff;"><i class="fas fa-balance-scale fa-2x text-accent"></i></div>
                <h3 class="text-accent" style="font-size: 1.8rem; line-height: 1.2;">Profit is an Opinion,<br>Cash is a Fact.</h3>
                <p class="mt-4"><strong>Accrual Accounting</strong> (GAAP) records transactions when they are <em>earned</em> or <em>incurred</em>, regardless of when cash moves.</p>
                <p><strong>Cash Accounting</strong> records transactions only when money hits the bank.</p>
            </div>
            <div class="card">
                <div class="icon-circle" style="background: #dcfce7;"><i class="fas fa-puzzle-piece fa-2x text-success"></i></div>
                <h3>Why Accrual?</h3>
                <p>It matches effort (expenses) with accomplishment (revenue). It provides a more accurate picture of long-term economic reality than simple cash movements.</p>
            </div>
        </div>
    </div>

    <div class="slide" id="slide-7">
        <h2>Cash vs. Accrual: A Tale of Two Profits</h2>
        <p>Scenario: In December, you sell $500 of goods on credit (customer pays in Jan).</p>
        <table class="financial-table mt-4" style="font-size: 1.2rem;">
            <thead>
                <tr>
                    <th></th>
                    <th>Accrual Basis (GAAP)</th>
                    <th>Cash Basis</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><strong>December Revenue</strong></td>
                    <td class="text-accent">$500 <span style="font-size:0.9rem; color:#64748b;">(Earned)</span></td>
                    <td class="text-error">$0 <span style="font-size:0.9rem; color:#64748b;">(No Cash)</span></td>
                </tr>
                <tr>
                    <td><strong>Dec Cost of Goods Sold</strong></td>
                    <td class="text-error">($200)</td>
                    <td>$0</td>
                </tr>
                <tr style="background: #f8fafc;">
                    <td><strong>Gross Margin Reported</strong></td>
                    <td class="text-accent" style="font-size: 1.5rem;">$300</td>
                    <td class="text-error" style="font-size: 1.5rem;">$0</td>
                </tr>
                <tr>
                    <td colspan="3" style="padding:0;">
                        <div class="card-success" style="padding: 1rem; margin: 1rem; border-radius: 12px; text-align:center;">
                            <strong>Reality:</strong> You did the work and sold the product. Accrual captures this economic reality.
                        </div>
                    </td>
                </tr>
            </tbody>
        </table>
    </div>

    <!-- Timeline Mismatch -->
    <div class="slide" id="slide-8">
        <h2>The Timing Mismatch</h2>
        <p>Revenue and Cash often move at different speeds. Notice the visual gap.</p>
        
        <div class="card" style="margin-bottom: 2rem;">
            <h3>Scenario 1: Credit Sale (Accrual)</h3>
            <p>You sell goods now, get paid later.</p>
            <div class="timeline-container">
                <div class="timeline-line"></div>
                <!-- Point 1 -->
                <div class="timeline-point" style="left: 20%;"></div>
                <div class="timeline-label" style="left: 20%;">Revenue Recorded<br><span style="font-weight:400; font-size:0.8rem;">(Income Statement)</span></div>
                <!-- Point 2 -->
                <div class="timeline-point" style="left: 80%; background: var(--success);"></div>
                <div class="timeline-label" style="left: 80%; color: var(--success);">Cash Received<br><span style="font-weight:400; font-size:0.8rem;">(Cash Flow)</span></div>
                <i class="fas fa-arrow-right fa-2x time-arrow"></i>
            </div>
            <p class="text-center text-accent" style="margin-top: 50px; font-weight: 800; font-size: 1.3rem; background: #e0e7ff; padding: 10px; border-radius: 50px; display: inline-block; position: relative; left: 50%; transform: translateX(-50%);">Gap = Accounts Receivable</p>
        </div>

        <div class="card">
            <h3>Scenario 2: Prepaid (Deferral)</h3>
            <p>Customer pays now, you deliver later.</p>
            <div class="timeline-container">
                <div class="timeline-line"></div>
                <!-- Point 1 -->
                <div class="timeline-point" style="left: 20%; background: var(--success);"></div>
                <div class="timeline-label" style="left: 20%; color: var(--success);">Cash Received<br><span style="font-weight:400; font-size:0.8rem;">(Cash Flow)</span></div>
                <!-- Point 2 -->
                <div class="timeline-point" style="left: 80%;"></div>
                <div class="timeline-label" style="left: 80%;">Revenue Recorded<br><span style="font-weight:400; font-size:0.8rem;">(Income Statement)</span></div>
                <i class="fas fa-arrow-right fa-2x time-arrow"></i>
            </div>
            <p class="text-center text-error" style="margin-top: 50px; font-weight: 800; font-size: 1.3rem; background: #ffe4e6; padding: 10px; border-radius: 50px; display: inline-block; position: relative; left: 50%; transform: translateX(-50%);">Gap = Unearned Revenue</p>
        </div>
    </div>

    <!-- ACT 3: FSET TRANSACTIONS -->
    <div class="slide" id="slide-9">
        <div class="flex-center" style="flex-direction: column; text-align: center; height: 100%;">
            <div class="icon-circle" style="background: #e0e7ff; width: 100px; height: 100px; margin-bottom: 20px;">
                <i class="fas fa-table fa-3x text-accent"></i>
            </div>
            <h2 style="border: none;">Act 3: The FSET Blueprint</h2>
            <h1 class="text-accent" style="font-size: 4rem; margin: 20px 0;">Assets = Liabilities + Equity</h1>
            <div class="fset-container" style="background: #f8fafc; border: 3px solid var(--accent-light); margin-top: 2rem; max-width: 1000px;">
                <table class="fset-table" style="border: none; box-shadow: none;">
                    <tr>
                        <th class="col-data" style="border-radius: 8px 0 0 8px;">Cash</th><th class="col-sign">+</th><th class="col-data">NonCash</th>
                        <th class="col-sign" style="color: var(--accent-blue);">=</th>
                        <th class="col-data">Liabilities</th><th class="col-sign">+</th><th class="col-data">Cont.Cap</th><th class="col-sign">+</th><th class="col-data">Earn.Cap</th>
                        <th class="col-sign" style="color: #94a3b8;">(</th><th class="col-data" style="background: #475569;">Rev</th><th class="col-sign">-</th><th class="col-data" style="background: #475569;">Exp</th><th class="col-sign">=</th><th class="col-data" style="background: #475569; border-radius: 0 8px 8px 0;">NI</th><th class="col-sign" style="color: #94a3b8;">)</th>
                    </tr>
                </table>
            </div>
            <p class="mt-4" style="font-size: 1.3rem; max-width: 800px;">This template ensures that every transaction balances the equation. Note that <strong>Revenue - Expenses = Net Income</strong>, which feeds into Earned Capital.</p>
        </div>
    </div>

    <!-- FSET DRILL 1 -->
    <div class="slide" id="slide-10">
        <h2>Drill 1: Purchase Inventory</h2>
        <p><strong>Transaction:</strong> Apple purchases $221,912 of inventory on account (credit).</p>
        
        <div class="flip-hint" onclick="this.classList.toggle('flipped')">
            <div class="flip-inner">
                <div class="flip-front"><i class="fas fa-lightbulb" style="margin-right: 5px;"></i> Need a Hint?</div>
                <div class="flip-back">We get an asset (Inventory), but we owe money (A/P).</div>
            </div>
        </div>
        
        <div class="fset-container">
            <button class="fset-reset-btn" onclick="resetFSET('drill-1-table')"><i class="fas fa-undo"></i> Reset Drill</button>
            <table class="fset-table" id="drill-1-table">
                <tr><th>Cash</th><th>NonCash</th><th>=</th><th>Liab</th><th>+</th><th>CC</th><th>+</th><th>EC</th><th>Rev</th><th>Exp</th><th>NI</th></tr>
                <tr>
                    <td><div class="fset-control" data-col="cash"><button class="fset-btn" onclick="toggleFSET(this, 'up')"><i class="fas fa-plus"></i></button><button class="fset-btn" onclick="toggleFSET(this, 'down')"><i class="fas fa-minus"></i></button></div></td>
                    <td><div class="fset-control" data-col="nca"><button class="fset-btn" onclick="toggleFSET(this, 'up')"><i class="fas fa-plus"></i></button><button class="fset-btn" onclick="toggleFSET(this, 'down')"><i class="fas fa-minus"></i></button></div></td>
                    <td style="font-weight: 900; font-size: 1.5rem; color: #cbd5e1;">=</td>
                    <td><div class="fset-control" data-col="liab"><button class="fset-btn" onclick="toggleFSET(this, 'up')"><i class="fas fa-plus"></i></button><button class="fset-btn" onclick="toggleFSET(this, 'down')"><i class="fas fa-minus"></i></button></div></td>
                    <td style="color: #cbd5e1; font-weight: bold;">+</td>
                    <td><div class="fset-control" data-col="cc"><button class="fset-btn" onclick="toggleFSET(this, 'up')"><i class="fas fa-plus"></i></button><button class="fset-btn" onclick="toggleFSET(this, 'down')"><i class="fas fa-minus"></i></button></div></td>
                    <td style="color: #cbd5e1; font-weight: bold;">+</td>
                    <td><div class="fset-control" data-col="ec"><button class="fset-btn" onclick="toggleFSET(this, 'up')"><i class="fas fa-plus"></i></button><button class="fset-btn" onclick="toggleFSET(this, 'down')"><i class="fas fa-minus"></i></button></div></td>
                    <td><div class="fset-control" data-col="rev"><button class="fset-btn" onclick="toggleFSET(this, 'up')"><i class="fas fa-plus"></i></button><button class="fset-btn" onclick="toggleFSET(this, 'down')"><i class="fas fa-minus"></i></button></div></td>
                    <td><div class="fset-control" data-col="exp"><button class="fset-btn" onclick="toggleFSET(this, 'up')"><i class="fas fa-plus"></i></button><button class="fset-btn" onclick="toggleFSET(this, 'down')"><i class="fas fa-minus"></i></button></div></td>
                    <td><div class="fset-control" data-col="ni"><button class="fset-btn" onclick="toggleFSET(this, 'up')"><i class="fas fa-plus"></i></button><button class="fset-btn" onclick="toggleFSET(this, 'down')"><i class="fas fa-minus"></i></button></div></td>
                </tr>
            </table>
            
            <div style="background: #f8fafc; padding: 1.5rem; border-radius: var(--radius-md); margin-top: 2rem;">
                <p style="margin:0; font-weight: bold; text-align: center;">Identify TWO Specific Accounts Involved:</p>
                <div class="account-selector-container">
                    <select id="drill-1-acct1" class="account-selector">
                        <option value="">-- Select Account 1 --</option>
                        <option value="inventory">Inventory</option>
                        <option value="cash">Cash</option>
                        <option value="ap">Accounts Payable</option>
                    </select>
                    <select id="drill-1-acct2" class="account-selector">
                        <option value="">-- Select Account 2 --</option>
                        <option value="inventory">Inventory</option>
                        <option value="ap">Accounts Payable</option>
                        <option value="wages">Wages Payable</option>
                    </select>
                </div>
                <div class="text-center">
                    <button class="btn-action mt-4" onclick="checkFSET('drill-1-table', ['nca-up', 'liab-up'], ['drill-1-acct1', 'drill-1-acct2'], ['inventory', 'ap'])">Check Answer</button>
                    <p class="feedback-msg"></p>
                </div>
            </div>
        </div>
    </div>

    <!-- FSET DRILL 2 -->
    <div class="slide" id="slide-11">
        <h2>Drill 2: Sell Product (Revenue)</h2>
        <p><strong>Transaction:</strong> Apple sells products for $394,328 Cash.</p>
        <p class="text-accent" style="background: #f5f3ff; padding: 5px 15px; border-radius: 20px; display: inline-block;"><strong>Note:</strong> Four columns are affected in this transaction.</p>
        
        <div class="flip-hint" onclick="this.classList.toggle('flipped')">
            <div class="flip-inner">
                <div class="flip-front"><i class="fas fa-lightbulb" style="margin-right: 5px;"></i> Need a Hint?</div>
                <div class="flip-back">Cash up. Revenue up. Net Income up. Earned Cap up.</div>
            </div>
        </div>
        
        <div class="fset-container">
            <button class="fset-reset-btn" onclick="resetFSET('drill-2-table')"><i class="fas fa-undo"></i> Reset Drill</button>
            <table class="fset-table" id="drill-2-table">
                <tr><th>Cash</th><th>NonCash</th><th>=</th><th>Liab</th><th>+</th><th>CC</th><th>+</th><th>EC</th><th>Rev</th><th>Exp</th><th>NI</th></tr>
                <tr>
                    <td><div class="fset-control" data-col="cash"><button class="fset-btn" onclick="toggleFSET(this, 'up')"><i class="fas fa-plus"></i></button><button class="fset-btn" onclick="toggleFSET(this, 'down')"><i class="fas fa-minus"></i></button></div></td>
                    <td><div class="fset-control" data-col="nca"><button class="fset-btn" onclick="toggleFSET(this, 'up')"><i class="fas fa-plus"></i></button><button class="fset-btn" onclick="toggleFSET(this, 'down')"><i class="fas fa-minus"></i></button></div></td>
                    <td style="font-weight: 900; font-size: 1.5rem; color: #cbd5e1;">=</td>
                    <td><div class="fset-control" data-col="liab"><button class="fset-btn" onclick="toggleFSET(this, 'up')"><i class="fas fa-plus"></i></button><button class="fset-btn" onclick="toggleFSET(this, 'down')"><i class="fas fa-minus"></i></button></div></td>
                    <td style="color: #cbd5e1; font-weight: bold;">+</td>
                    <td><div class="fset-control" data-col="cc"><button class="fset-btn" onclick="toggleFSET(this, 'up')"><i class="fas fa-plus"></i></button><button class="fset-btn" onclick="toggleFSET(this, 'down')"><i class="fas fa-minus"></i></button></div></td>
                    <td style="color: #cbd5e1; font-weight: bold;">+</td>
                    <td><div class="fset-control" data-col="ec"><button class="fset-btn" onclick="toggleFSET(this, 'up')"><i class="fas fa-plus"></i></button><button class="fset-btn" onclick="toggleFSET(this, 'down')"><i class="fas fa-minus"></i></button></div></td>
                    <td><div class="fset-control" data-col="rev"><button class="fset-btn" onclick="toggleFSET(this, 'up')"><i class="fas fa-plus"></i></button><button class="fset-btn" onclick="toggleFSET(this, 'down')"><i class="fas fa-minus"></i></button></div></td>
                    <td><div class="fset-control" data-col="exp"><button class="fset-btn" onclick="toggleFSET(this, 'up')"><i class="fas fa-plus"></i></button><button class="fset-btn" onclick="toggleFSET(this, 'down')"><i class="fas fa-minus"></i></button></div></td>
                    <td><div class="fset-control" data-col="ni"><button class="fset-btn" onclick="toggleFSET(this, 'up')"><i class="fas fa-plus"></i></button><button class="fset-btn" onclick="toggleFSET(this, 'down')"><i class="fas fa-minus"></i></button></div></td>
                </tr>
            </table>
            
            <div style="background: #f8fafc; padding: 1.5rem; border-radius: var(--radius-md); margin-top: 2rem;">
                <p style="margin:0; font-weight: bold; text-align: center;">Identify TWO Specific Accounts Involved:</p>
                <div class="account-selector-container">
                    <select id="drill-2-acct1" class="account-selector">
                        <option value="">-- Select Account 1 --</option>
                        <option value="cash">Cash</option>
                        <option value="rev">Sales Revenue</option>
                        <option value="ar">Accounts Receivable</option>
                    </select>
                    <select id="drill-2-acct2" class="account-selector">
                        <option value="">-- Select Account 2 --</option>
                        <option value="cash">Cash</option>
                        <option value="rev">Sales Revenue</option>
                        <option value="unearned">Unearned Revenue</option>
                    </select>
                </div>
                <div class="text-center">
                    <button class="btn-action mt-4" onclick="checkFSET('drill-2-table', ['cash-up', 'rev-up', 'ni-up', 'ec-up'], ['drill-2-acct1', 'drill-2-acct2'], ['cash', 'rev'])">Check Answer</button>
                    <p class="feedback-msg"></p>
                </div>
            </div>
        </div>
    </div>

    <!-- FSET DRILL 3 -->
    <div class="slide" id="slide-12">
        <h2>Drill 3: Sell Product (Expense)</h2>
        <p><strong>Transaction:</strong> Record the Cost of Goods Sold ($223,546) for the sale in Drill 2.</p>
        <p class="text-accent" style="background: #f5f3ff; padding: 5px 15px; border-radius: 20px; display: inline-block;"><strong>Note:</strong> Four columns are affected in this transaction.</p>
        
        <div class="flip-hint" onclick="this.classList.toggle('flipped')">
            <div class="flip-inner">
                <div class="flip-front"><i class="fas fa-lightbulb" style="margin-right: 5px;"></i> Need a Hint?</div>
                <div class="flip-back">Inventory leaves. Expense up. Net Income down. Earned Cap down.</div>
            </div>
        </div>
        
        <div class="fset-container">
            <button class="fset-reset-btn" onclick="resetFSET('drill-3-table')"><i class="fas fa-undo"></i> Reset Drill</button>
            <table class="fset-table" id="drill-3-table">
                <tr><th>Cash</th><th>NonCash</th><th>=</th><th>Liab</th><th>+</th><th>CC</th><th>+</th><th>EC</th><th>Rev</th><th>Exp</th><th>NI</th></tr>
                <tr>
                    <td><div class="fset-control" data-col="cash"><button class="fset-btn" onclick="toggleFSET(this, 'up')"><i class="fas fa-plus"></i></button><button class="fset-btn" onclick="toggleFSET(this, 'down')"><i class="fas fa-minus"></i></button></div></td>
                    <td><div class="fset-control" data-col="nca"><button class="fset-btn" onclick="toggleFSET(this, 'up')"><i class="fas fa-plus"></i></button><button class="fset-btn" onclick="toggleFSET(this, 'down')"><i class="fas fa-minus"></i></button></div></td>
                    <td style="font-weight: 900; font-size: 1.5rem; color: #cbd5e1;">=</td>
                    <td><div class="fset-control" data-col="liab"><button class="fset-btn" onclick="toggleFSET(this, 'up')"><i class="fas fa-plus"></i></button><button class="fset-btn" onclick="toggleFSET(this, 'down')"><i class="fas fa-minus"></i></button></div></td>
                    <td style="color: #cbd5e1; font-weight: bold;">+</td>
                    <td><div class="fset-control" data-col="cc"><button class="fset-btn" onclick="toggleFSET(this, 'up')"><i class="fas fa-plus"></i></button><button class="fset-btn" onclick="toggleFSET(this, 'down')"><i class="fas fa-minus"></i></button></div></td>
                    <td style="color: #cbd5e1; font-weight: bold;">+</td>
                    <td><div class="fset-control" data-col="ec"><button class="fset-btn" onclick="toggleFSET(this, 'up')"><i class="fas fa-plus"></i></button><button class="fset-btn" onclick="toggleFSET(this, 'down')"><i class="fas fa-minus"></i></button></div></td>
                    <td><div class="fset-control" data-col="rev"><button class="fset-btn" onclick="toggleFSET(this, 'up')"><i class="fas fa-plus"></i></button><button class="fset-btn" onclick="toggleFSET(this, 'down')"><i class="fas fa-minus"></i></button></div></td>
                    <td><div class="fset-control" data-col="exp"><button class="fset-btn" onclick="toggleFSET(this, 'up')"><i class="fas fa-plus"></i></button><button class="fset-btn" onclick="toggleFSET(this, 'down')"><i class="fas fa-minus"></i></button></div></td>
                    <td><div class="fset-control" data-col="ni"><button class="fset-btn" onclick="toggleFSET(this, 'up')"><i class="fas fa-plus"></i></button><button class="fset-btn" onclick="toggleFSET(this, 'down')"><i class="fas fa-minus"></i></button></div></td>
                </tr>
            </table>

            <div style="background: #f8fafc; padding: 1.5rem; border-radius: var(--radius-md); margin-top: 2rem;">
                <p style="margin:0; font-weight: bold; text-align: center;">Identify TWO Specific Accounts Involved:</p>
                <div class="account-selector-container">
                    <select id="drill-3-acct1" class="account-selector">
                        <option value="">-- Select Account 1 --</option>
                        <option value="inventory">Inventory</option>
                        <option value="cogs">Cost of Goods Sold (Exp)</option>
                        <option value="ppe">Property Plant Equipment</option>
                    </select>
                    <select id="drill-3-acct2" class="account-selector">
                        <option value="">-- Select Account 2 --</option>
                        <option value="inventory">Inventory</option>
                        <option value="cogs">Cost of Goods Sold (Exp)</option>
                        <option value="supplies">Supplies</option>
                    </select>
                </div>
                <div class="text-center">
                    <button class="btn-action mt-4" onclick="checkFSET('drill-3-table', ['nca-down', 'exp-up', 'ni-down', 'ec-down'], ['drill-3-acct1', 'drill-3-acct2'], ['inventory', 'cogs'])">Check Answer</button>
                    <p class="feedback-msg"></p>
                </div>
            </div>
        </div>
    </div>

    <!-- FSET DRILL 4 -->
    <div class="slide" id="slide-13">
        <h2>Drill 4: Pay Accounts Payable</h2>
        <p><strong>Transaction:</strong> Apple pays $212,500 cash toward what it owes suppliers.</p>
        
        <div class="flip-hint" onclick="this.classList.toggle('flipped')">
            <div class="flip-inner">
                <div class="flip-front"><i class="fas fa-lightbulb" style="margin-right: 5px;"></i> Need a Hint?</div>
                <div class="flip-back">Cash goes out. Liability decreases.</div>
            </div>
        </div>

        <div class="fset-container">
            <button class="fset-reset-btn" onclick="resetFSET('drill-4-table')"><i class="fas fa-undo"></i> Reset Drill</button>
            <table class="fset-table" id="drill-4-table">
                <tr><th>Cash</th><th>NonCash</th><th>=</th><th>Liab</th><th>+</th><th>CC</th><th>+</th><th>EC</th><th>Rev</th><th>Exp</th><th>NI</th></tr>
                <tr>
                    <td><div class="fset-control" data-col="cash"><button class="fset-btn" onclick="toggleFSET(this, 'up')"><i class="fas fa-plus"></i></button><button class="fset-btn" onclick="toggleFSET(this, 'down')"><i class="fas fa-minus"></i></button></div></td>
                    <td><div class="fset-control" data-col="nca"><button class="fset-btn" onclick="toggleFSET(this, 'up')"><i class="fas fa-plus"></i></button><button class="fset-btn" onclick="toggleFSET(this, 'down')"><i class="fas fa-minus"></i></button></div></td>
                    <td style="font-weight: 900; font-size: 1.5rem; color: #cbd5e1;">=</td>
                    <td><div class="fset-control" data-col="liab"><button class="fset-btn" onclick="toggleFSET(this, 'up')"><i class="fas fa-plus"></i></button><button class="fset-btn" onclick="toggleFSET(this, 'down')"><i class="fas fa-minus"></i></button></div></td>
                    <td style="color: #cbd5e1; font-weight: bold;">+</td>
                    <td><div class="fset-control" data-col="cc"><button class="fset-btn" onclick="toggleFSET(this, 'up')"><i class="fas fa-plus"></i></button><button class="fset-btn" onclick="toggleFSET(this, 'down')"><i class="fas fa-minus"></i></button></div></td>
                    <td style="color: #cbd5e1; font-weight: bold;">+</td>
                    <td><div class="fset-control" data-col="ec"><button class="fset-btn" onclick="toggleFSET(this, 'up')"><i class="fas fa-plus"></i></button><button class="fset-btn" onclick="toggleFSET(this, 'down')"><i class="fas fa-minus"></i></button></div></td>
                    <td><div class="fset-control" data-col="rev"><button class="fset-btn" onclick="toggleFSET(this, 'up')"><i class="fas fa-plus"></i></button><button class="fset-btn" onclick="toggleFSET(this, 'down')"><i class="fas fa-minus"></i></button></div></td>
                    <td><div class="fset-control" data-col="exp"><button class="fset-btn" onclick="toggleFSET(this, 'up')"><i class="fas fa-plus"></i></button><button class="fset-btn" onclick="toggleFSET(this, 'down')"><i class="fas fa-minus"></i></button></div></td>
                    <td><div class="fset-control" data-col="ni"><button class="fset-btn" onclick="toggleFSET(this, 'up')"><i class="fas fa-plus"></i></button><button class="fset-btn" onclick="toggleFSET(this, 'down')"><i class="fas fa-minus"></i></button></div></td>
                </tr>
            </table>
            
            <div style="background: #f8fafc; padding: 1.5rem; border-radius: var(--radius-md); margin-top: 2rem;">
                <p style="margin:0; font-weight: bold; text-align: center;">Identify TWO Specific Accounts Involved:</p>
                <div class="account-selector-container">
                    <select id="drill-4-acct1" class="account-selector">
                        <option value="">-- Select Account 1 --</option>
                        <option value="cash">Cash</option>
                        <option value="ap">Accounts Payable</option>
                        <option value="ar">Accounts Receivable</option>
                    </select>
                    <select id="drill-4-acct2" class="account-selector">
                        <option value="">-- Select Account 2 --</option>
                        <option value="cash">Cash</option>
                        <option value="ap">Accounts Payable</option>
                        <option value="bonds">Bonds Payable</option>
                    </select>
                </div>
                <div class="text-center">
                    <button class="btn-action mt-4" onclick="checkFSET('drill-4-table', ['cash-down', 'liab-down'], ['drill-4-acct1', 'drill-4-acct2'], ['cash', 'ap'])">Check Answer</button>
                    <p class="feedback-msg"></p>
                </div>
            </div>
        </div>
    </div>

    <!-- ACT 4: ADJUSTMENTS -->
    <div class="slide" id="slide-14">
        <h2>Act 4: Adjustments</h2>
        <p>Adjustments ensure that revenues and expenses are recorded in the correct period.</p>
        
        <div class="grid-2-wide">
            <!-- Deferral -->
            <div class="card card-warn" style="min-width: 350px;">
                <div class="icon-circle" style="background: #fffbeb;"><i class="fas fa-calendar-alt fa-2x text-warning" style="color:var(--warning)"></i></div>
                <h4>Deferrals (Prepayments)</h4>
                <div class="timeline-container">
                    <div class="timeline-line"></div>
                    <div class="timeline-point" style="left: 10%; background: var(--success);"></div>
                    <div class="timeline-label" style="left: 10%; color: var(--success);">Cash Paid</div>
                    <div class="timeline-point" style="left: 90%;"></div>
                    <div class="timeline-label" style="left: 90%;">Expense Recorded</div>
                </div>
                <div class="flip-card" onclick="this.classList.toggle('flipped')" style="height: 120px; margin-top: 50px;">
                    <div class="flip-inner">
                        <div class="flip-front" style="padding: 1rem; background: var(--gradient-fun);"><h5>Example Transaction</h5></div>
                        <div class="flip-back" style="padding: 1rem;"><p style="font-size: 1rem; font-weight: bold;">Paying for 12 months of Insurance upfront.</p></div>
                    </div>
                </div>
            </div>

            <!-- Accrual -->
            <div class="card card-warn" style="min-width: 350px;">
                <div class="icon-circle" style="background: #fffbeb;"><i class="fas fa-bolt fa-2x text-warning" style="color:var(--warning)"></i></div>
                <h4>Accruals</h4>
                <div class="timeline-container">
                    <div class="timeline-line"></div>
                    <div class="timeline-point" style="left: 10%;"></div>
                    <div class="timeline-label" style="left: 10%;">Expense Recorded</div>
                    <div class="timeline-point" style="left: 90%; background: var(--success);"></div>
                    <div class="timeline-label" style="left: 90%; color: var(--success);">Cash Paid</div>
                </div>
                <div class="flip-card" onclick="this.classList.toggle('flipped')" style="height: 120px; margin-top: 50px;">
                    <div class="flip-inner">
                        <div class="flip-front" style="padding: 1rem; background: var(--gradient-fun);"><h5>Example Transaction</h5></div>
                        <div class="flip-back" style="padding: 1rem;"><p style="font-size: 1rem; font-weight: bold;">Electricity bill received in Jan for Dec usage.</p></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- DRILL 5: PREPAID EXP -->
    <div class="slide" id="slide-15">
        <h2>Adj Drill 1: Prepaid Expense</h2>
        <p><strong>Scenario:</strong> You paid $200 for insurance last year. $50 of it has now been used.</p>
        
        <div class="flip-hint" onclick="this.classList.toggle('flipped')">
            <div class="flip-inner">
                <div class="flip-front"><i class="fas fa-lightbulb" style="margin-right: 5px;"></i> Need a Hint?</div>
                <div class="flip-back">Prepaid Asset down. Expense up. Net Inc down. Earned Cap down.</div>
            </div>
        </div>
        
        <div class="fset-container">
            <button class="fset-reset-btn" onclick="resetFSET('drill-5-table')"><i class="fas fa-undo"></i> Reset Drill</button>
            <table class="fset-table" id="drill-5-table">
                <tr><th>Cash</th><th>NonCash</th><th>=</th><th>Liab</th><th>+</th><th>CC</th><th>+</th><th>EC</th><th>Rev</th><th>Exp</th><th>NI</th></tr>
                <tr>
                    <td><div class="fset-control" data-col="cash"><button class="fset-btn" onclick="toggleFSET(this, 'up')"><i class="fas fa-plus"></i></button><button class="fset-btn" onclick="toggleFSET(this, 'down')"><i class="fas fa-minus"></i></button></div></td>
                    <td><div class="fset-control" data-col="nca"><button class="fset-btn" onclick="toggleFSET(this, 'up')"><i class="fas fa-plus"></i></button><button class="fset-btn" onclick="toggleFSET(this, 'down')"><i class="fas fa-minus"></i></button></div></td>
                    <td style="font-weight: 900; font-size: 1.5rem; color: #cbd5e1;">=</td>
                    <td><div class="fset-control" data-col="liab"><button class="fset-btn" onclick="toggleFSET(this, 'up')"><i class="fas fa-plus"></i></button><button class="fset-btn" onclick="toggleFSET(this, 'down')"><i class="fas fa-minus"></i></button></div></td>
                    <td style="color: #cbd5e1; font-weight: bold;">+</td>
                    <td><div class="fset-control" data-col="cc"><button class="fset-btn" onclick="toggleFSET(this, 'up')"><i class="fas fa-plus"></i></button><button class="fset-btn" onclick="toggleFSET(this, 'down')"><i class="fas fa-minus"></i></button></div></td>
                    <td style="color: #cbd5e1; font-weight: bold;">+</td>
                    <td><div class="fset-control" data-col="ec"><button class="fset-btn" onclick="toggleFSET(this, 'up')"><i class="fas fa-plus"></i></button><button class="fset-btn" onclick="toggleFSET(this, 'down')"><i class="fas fa-minus"></i></button></div></td>
                    <td><div class="fset-control" data-col="rev"><button class="fset-btn" onclick="toggleFSET(this, 'up')"><i class="fas fa-plus"></i></button><button class="fset-btn" onclick="toggleFSET(this, 'down')"><i class="fas fa-minus"></i></button></div></td>
                    <td><div class="fset-control" data-col="exp"><button class="fset-btn" onclick="toggleFSET(this, 'up')"><i class="fas fa-plus"></i></button><button class="fset-btn" onclick="toggleFSET(this, 'down')"><i class="fas fa-minus"></i></button></div></td>
                    <td><div class="fset-control" data-col="ni"><button class="fset-btn" onclick="toggleFSET(this, 'up')"><i class="fas fa-plus"></i></button><button class="fset-btn" onclick="toggleFSET(this, 'down')"><i class="fas fa-minus"></i></button></div></td>
                </tr>
            </table>

            <div style="background: #f8fafc; padding: 1.5rem; border-radius: var(--radius-md); margin-top: 2rem;">
                <p style="margin:0; font-weight: bold; text-align: center;">Identify TWO Specific Accounts Involved:</p>
                <div class="account-selector-container">
                    <select id="drill-5-acct1" class="account-selector">
                        <option value="">-- Select Account 1 --</option>
                        <option value="prepaid">Prepaid Expense (Asset)</option>
                        <option value="ins_exp">Insurance Expense</option>
                        <option value="cash">Cash</option>
                    </select>
                    <select id="drill-5-acct2" class="account-selector">
                        <option value="">-- Select Account 2 --</option>
                        <option value="prepaid">Prepaid Expense (Asset)</option>
                        <option value="ins_exp">Insurance Expense</option>
                        <option value="liab">Insurance Payable</option>
                    </select>
                </div>
                <div class="text-center">
                    <button class="btn-action mt-4" onclick="checkFSET('drill-5-table', ['nca-down', 'exp-up', 'ni-down', 'ec-down'], ['drill-5-acct1', 'drill-5-acct2'], ['prepaid', 'ins_exp'])">Check Answer</button>
                    <p class="feedback-msg"></p>
                </div>
            </div>
        </div>
    </div>

    <!-- DRILL 6: UNEARNED REV -->
    <div class="slide" id="slide-16">
        <h2>Adj Drill 2: Unearned Revenue</h2>
        <p><strong>Scenario:</strong> A customer paid $400 in advance for an iPad. You have now delivered it.</p>
        
        <div class="flip-hint" onclick="this.classList.toggle('flipped')">
            <div class="flip-inner">
                <div class="flip-front"><i class="fas fa-lightbulb" style="margin-right: 5px;"></i> Need a Hint?</div>
                <div class="flip-back">Liability (Unearned Rev) down. Rev up. NI up. EC up.</div>
            </div>
        </div>
        
        <div class="fset-container">
            <button class="fset-reset-btn" onclick="resetFSET('drill-6-table')"><i class="fas fa-undo"></i> Reset Drill</button>
            <table class="fset-table" id="drill-6-table">
                <tr><th>Cash</th><th>NonCash</th><th>=</th><th>Liab</th><th>+</th><th>CC</th><th>+</th><th>EC</th><th>Rev</th><th>Exp</th><th>NI</th></tr>
                <tr>
                    <td><div class="fset-control" data-col="cash"><button class="fset-btn" onclick="toggleFSET(this, 'up')"><i class="fas fa-plus"></i></button><button class="fset-btn" onclick="toggleFSET(this, 'down')"><i class="fas fa-minus"></i></button></div></td>
                    <td><div class="fset-control" data-col="nca"><button class="fset-btn" onclick="toggleFSET(this, 'up')"><i class="fas fa-plus"></i></button><button class="fset-btn" onclick="toggleFSET(this, 'down')"><i class="fas fa-minus"></i></button></div></td>
                    <td style="font-weight: 900; font-size: 1.5rem; color: #cbd5e1;">=</td>
                    <td><div class="fset-control" data-col="liab"><button class="fset-btn" onclick="toggleFSET(this, 'up')"><i class="fas fa-plus"></i></button><button class="fset-btn" onclick="toggleFSET(this, 'down')"><i class="fas fa-minus"></i></button></div></td>
                    <td style="color: #cbd5e1; font-weight: bold;">+</td>
                    <td><div class="fset-control" data-col="cc"><button class="fset-btn" onclick="toggleFSET(this, 'up')"><i class="fas fa-plus"></i></button><button class="fset-btn" onclick="toggleFSET(this, 'down')"><i class="fas fa-minus"></i></button></div></td>
                    <td style="color: #cbd5e1; font-weight: bold;">+</td>
                    <td><div class="fset-control" data-col="ec"><button class="fset-btn" onclick="toggleFSET(this, 'up')"><i class="fas fa-plus"></i></button><button class="fset-btn" onclick="toggleFSET(this, 'down')"><i class="fas fa-minus"></i></button></div></td>
                    <td><div class="fset-control" data-col="rev"><button class="fset-btn" onclick="toggleFSET(this, 'up')"><i class="fas fa-plus"></i></button><button class="fset-btn" onclick="toggleFSET(this, 'down')"><i class="fas fa-minus"></i></button></div></td>
                    <td><div class="fset-control" data-col="exp"><button class="fset-btn" onclick="toggleFSET(this, 'up')"><i class="fas fa-plus"></i></button><button class="fset-btn" onclick="toggleFSET(this, 'down')"><i class="fas fa-minus"></i></button></div></td>
                    <td><div class="fset-control" data-col="ni"><button class="fset-btn" onclick="toggleFSET(this, 'up')"><i class="fas fa-plus"></i></button><button class="fset-btn" onclick="toggleFSET(this, 'down')"><i class="fas fa-minus"></i></button></div></td>
                </tr>
            </table>

            <div style="background: #f8fafc; padding: 1.5rem; border-radius: var(--radius-md); margin-top: 2rem;">
                <p style="margin:0; font-weight: bold; text-align: center;">Identify TWO Specific Accounts Involved:</p>
                <div class="account-selector-container">
                    <select id="drill-6-acct1" class="account-selector">
                        <option value="">-- Select Account 1 --</option>
                        <option value="unearned">Unearned Revenue</option>
                        <option value="sales">Sales Revenue</option>
                        <option value="cash">Cash</option>
                    </select>
                    <select id="drill-6-acct2" class="account-selector">
                        <option value="">-- Select Account 2 --</option>
                        <option value="unearned">Unearned Revenue</option>
                        <option value="sales">Sales Revenue</option>
                        <option value="ar">Accounts Receivable</option>
                    </select>
                </div>
                <div class="text-center">
                    <button class="btn-action mt-4" onclick="checkFSET('drill-6-table', ['liab-down', 'rev-up', 'ni-up', 'ec-up'], ['drill-6-acct1', 'drill-6-acct2'], ['unearned', 'sales'])">Check Answer</button>
                    <p class="feedback-msg"></p>
                </div>
            </div>
        </div>
    </div>

    <!-- NEW DRILL 7: ACCRUE INTEREST -->
    <div class="slide" id="slide-17">
        <h2>Adj Drill 3: Accrue Interest</h2>
        <p><strong>Scenario:</strong> You owe $100 in interest on a bank loan for this month. You will pay it next month.</p>
        
        <div class="flip-hint" onclick="this.classList.toggle('flipped')">
            <div class="flip-inner">
                <div class="flip-front"><i class="fas fa-lightbulb" style="margin-right: 5px;"></i> Need a Hint?</div>
                <div class="flip-back">Liability up. Expense up. Net Inc down. Earned Cap down.</div>
            </div>
        </div>
        
        <div class="fset-container">
            <button class="fset-reset-btn" onclick="resetFSET('drill-7-table')"><i class="fas fa-undo"></i> Reset Drill</button>
            <table class="fset-table" id="drill-7-table">
                <tr><th>Cash</th><th>NonCash</th><th>=</th><th>Liab</th><th>+</th><th>CC</th><th>+</th><th>EC</th><th>Rev</th><th>Exp</th><th>NI</th></tr>
                <tr>
                    <td><div class="fset-control" data-col="cash"><button class="fset-btn" onclick="toggleFSET(this, 'up')"><i class="fas fa-plus"></i></button><button class="fset-btn" onclick="toggleFSET(this, 'down')"><i class="fas fa-minus"></i></button></div></td>
                    <td><div class="fset-control" data-col="nca"><button class="fset-btn" onclick="toggleFSET(this, 'up')"><i class="fas fa-plus"></i></button><button class="fset-btn" onclick="toggleFSET(this, 'down')"><i class="fas fa-minus"></i></button></div></td>
                    <td style="font-weight: 900; font-size: 1.5rem; color: #cbd5e1;">=</td>
                    <td><div class="fset-control" data-col="liab"><button class="fset-btn" onclick="toggleFSET(this, 'up')"><i class="fas fa-plus"></i></button><button class="fset-btn" onclick="toggleFSET(this, 'down')"><i class="fas fa-minus"></i></button></div></td>
                    <td style="color: #cbd5e1; font-weight: bold;">+</td>
                    <td><div class="fset-control" data-col="cc"><button class="fset-btn" onclick="toggleFSET(this, 'up')"><i class="fas fa-plus"></i></button><button class="fset-btn" onclick="toggleFSET(this, 'down')"><i class="fas fa-minus"></i></button></div></td>
                    <td style="color: #cbd5e1; font-weight: bold;">+</td>
                    <td><div class="fset-control" data-col="ec"><button class="fset-btn" onclick="toggleFSET(this, 'up')"><i class="fas fa-plus"></i></button><button class="fset-btn" onclick="toggleFSET(this, 'down')"><i class="fas fa-minus"></i></button></div></td>
                    <td><div class="fset-control" data-col="rev"><button class="fset-btn" onclick="toggleFSET(this, 'up')"><i class="fas fa-plus"></i></button><button class="fset-btn" onclick="toggleFSET(this, 'down')"><i class="fas fa-minus"></i></button></div></td>
                    <td><div class="fset-control" data-col="exp"><button class="fset-btn" onclick="toggleFSET(this, 'up')"><i class="fas fa-plus"></i></button><button class="fset-btn" onclick="toggleFSET(this, 'down')"><i class="fas fa-minus"></i></button></div></td>
                    <td><div class="fset-control" data-col="ni"><button class="fset-btn" onclick="toggleFSET(this, 'up')"><i class="fas fa-plus"></i></button><button class="fset-btn" onclick="toggleFSET(this, 'down')"><i class="fas fa-minus"></i></button></div></td>
                </tr>
            </table>

            <div style="background: #f8fafc; padding: 1.5rem; border-radius: var(--radius-md); margin-top: 2rem;">
                <p style="margin:0; font-weight: bold; text-align: center;">Identify TWO Specific Accounts Involved:</p>
                <div class="account-selector-container">
                    <select id="drill-7-acct1" class="account-selector">
                        <option value="">-- Select Account 1 --</option>
                        <option value="int_pay">Interest Payable</option>
                        <option value="int_exp">Interest Expense</option>
                        <option value="cash">Cash</option>
                    </select>
                    <select id="drill-7-acct2" class="account-selector">
                        <option value="">-- Select Account 2 --</option>
                        <option value="int_pay">Interest Payable</option>
                        <option value="int_exp">Interest Expense</option>
                        <option value="loan">Loan Principal</option>
                    </select>
                </div>
                <div class="text-center">
                    <button class="btn-action mt-4" onclick="checkFSET('drill-7-table', ['liab-up', 'exp-up', 'ni-down', 'ec-down'], ['drill-7-acct1', 'drill-7-acct2'], ['int_pay', 'int_exp'])">Check Answer</button>
                    <p class="feedback-msg"></p>
                </div>
            </div>
        </div>
    </div>

    <!-- NEW DRILL 8: DEPRECIATION -->
    <div class="slide" id="slide-18">
        <h2>Adj Drill 4: Depreciation</h2>
        <p><strong>Scenario:</strong> Record $500 of depreciation on your factory equipment for the year.</p>
        
        <div class="flip-hint" onclick="this.classList.toggle('flipped')">
            <div class="flip-inner">
                <div class="flip-front"><i class="fas fa-lightbulb" style="margin-right: 5px;"></i> Need a Hint?</div>
                <div class="flip-back">NonCash decreases (Accum. Depr). Expense up. NI down. EC down.</div>
            </div>
        </div>
        
        <div class="fset-container">
            <button class="fset-reset-btn" onclick="resetFSET('drill-8-table')"><i class="fas fa-undo"></i> Reset Drill</button>
            <table class="fset-table" id="drill-8-table">
                <tr><th>Cash</th><th>NonCash</th><th>=</th><th>Liab</th><th>+</th><th>CC</th><th>+</th><th>EC</th><th>Rev</th><th>Exp</th><th>NI</th></tr>
                <tr>
                    <td><div class="fset-control" data-col="cash"><button class="fset-btn" onclick="toggleFSET(this, 'up')"><i class="fas fa-plus"></i></button><button class="fset-btn" onclick="toggleFSET(this, 'down')"><i class="fas fa-minus"></i></button></div></td>
                    <td><div class="fset-control" data-col="nca"><button class="fset-btn" onclick="toggleFSET(this, 'up')"><i class="fas fa-plus"></i></button><button class="fset-btn" onclick="toggleFSET(this, 'down')"><i class="fas fa-minus"></i></button></div></td>
                    <td style="font-weight: 900; font-size: 1.5rem; color: #cbd5e1;">=</td>
                    <td><div class="fset-control" data-col="liab"><button class="fset-btn" onclick="toggleFSET(this, 'up')"><i class="fas fa-plus"></i></button><button class="fset-btn" onclick="toggleFSET(this, 'down')"><i class="fas fa-minus"></i></button></div></td>
                    <td style="color: #cbd5e1; font-weight: bold;">+</td>
                    <td><div class="fset-control" data-col="cc"><button class="fset-btn" onclick="toggleFSET(this, 'up')"><i class="fas fa-plus"></i></button><button class="fset-btn" onclick="toggleFSET(this, 'down')"><i class="fas fa-minus"></i></button></div></td>
                    <td style="color: #cbd5e1; font-weight: bold;">+</td>
                    <td><div class="fset-control" data-col="ec"><button class="fset-btn" onclick="toggleFSET(this, 'up')"><i class="fas fa-plus"></i></button><button class="fset-btn" onclick="toggleFSET(this, 'down')"><i class="fas fa-minus"></i></button></div></td>
                    <td><div class="fset-control" data-col="rev"><button class="fset-btn" onclick="toggleFSET(this, 'up')"><i class="fas fa-plus"></i></button><button class="fset-btn" onclick="toggleFSET(this, 'down')"><i class="fas fa-minus"></i></button></div></td>
                    <td><div class="fset-control" data-col="exp"><button class="fset-btn" onclick="toggleFSET(this, 'up')"><i class="fas fa-plus"></i></button><button class="fset-btn" onclick="toggleFSET(this, 'down')"><i class="fas fa-minus"></i></button></div></td>
                    <td><div class="fset-control" data-col="ni"><button class="fset-btn" onclick="toggleFSET(this, 'up')"><i class="fas fa-plus"></i></button><button class="fset-btn" onclick="toggleFSET(this, 'down')"><i class="fas fa-minus"></i></button></div></td>
                </tr>
            </table>

            <div style="background: #f8fafc; padding: 1.5rem; border-radius: var(--radius-md); margin-top: 2rem;">
                <p style="margin:0; font-weight: bold; text-align: center;">Identify TWO Specific Accounts Involved:</p>
                <div class="account-selector-container">
                    <select id="drill-8-acct1" class="account-selector">
                        <option value="">-- Select Account 1 --</option>
                        <option value="accum_depr">Accumulated Depreciation</option>
                        <option value="depr_exp">Depreciation Expense</option>
                        <option value="cash">Cash</option>
                    </select>
                    <select id="drill-8-acct2" class="account-selector">
                        <option value="">-- Select Account 2 --</option>
                        <option value="accum_depr">Accumulated Depreciation</option>
                        <option value="depr_exp">Depreciation Expense</option>
                        <option value="ppe">Equipment (Gross)</option>
                    </select>
                </div>
                <div class="text-center">
                    <button class="btn-action mt-4" onclick="checkFSET('drill-8-table', ['nca-down', 'exp-up', 'ni-down', 'ec-down'], ['drill-8-acct1', 'drill-8-acct2'], ['accum_depr', 'depr_exp'])">Check Answer</button>
                    <p class="feedback-msg"></p>
                </div>
            </div>
        </div>
    </div>

    <!-- NEW: IMPACT OF ERRORS -->
    <div class="slide" id="slide-19">
        <h2>Impact of Errors (Omissions)</h2>
        <p>What happens if we FORGET to record adjustments?</p>
        <div class="grid-2">
            <div class="card">
                <div class="icon-circle" style="background: #fffbeb;"><i class="fas fa-exclamation-triangle fa-2x text-warning" style="color:var(--warning)"></i></div>
                <h3>Scenario A</h3>
                <p>Forgot to record Accrued Wages Expense.</p>
                <div style="background: #f8fafc; padding: 1.5rem; margin-top: 1rem; border-radius: var(--radius-md); border: 2px solid #e2e8f0;">
                    <p><strong>Expenses:</strong> <select id="err-1-exp" class="account-selector" style="margin-top:0; padding:5px; width:auto;"><option>--</option><option value="under">Understated</option><option value="over">Overstated</option></select></p>
                    <p><strong>Net Income:</strong> <select id="err-1-ni" class="account-selector" style="margin-top:0; padding:5px; width:auto;"><option>--</option><option value="under">Understated</option><option value="over">Overstated</option></select></p>
                    <p><strong>Liabilities:</strong> <select id="err-1-liab" class="account-selector" style="margin-top:0; padding:5px; width:auto;"><option>--</option><option value="under">Understated</option><option value="over">Overstated</option></select></p>
                    <div class="text-center"><button class="btn-action" onclick="checkError(1, 'under', 'under', 'over')">Check</button></div>
                    <p id="err-msg-1" class="feedback-msg"></p>
                </div>
            </div>
            <div class="card">
                <div class="icon-circle" style="background: #fffbeb;"><i class="fas fa-exclamation-triangle fa-2x text-warning" style="color:var(--warning)"></i></div>
                <h3>Scenario B</h3>
                <p>Forgot to record Depreciation.</p>
                <div style="background: #f8fafc; padding: 1.5rem; margin-top: 1rem; border-radius: var(--radius-md); border: 2px solid #e2e8f0;">
                    <p><strong>Expenses:</strong> <select id="err-2-exp" class="account-selector" style="margin-top:0; padding:5px; width:auto;"><option>--</option><option value="under">Understated</option><option value="over">Overstated</option></select></p>
                    <p><strong>Assets:</strong> <select id="err-2-ast" class="account-selector" style="margin-top:0; padding:5px; width:auto;"><option>--</option><option value="under">Understated</option><option value="over">Overstated</option></select></p>
                    <p><strong>Net Income:</strong> <select id="err-2-ni" class="account-selector" style="margin-top:0; padding:5px; width:auto;"><option>--</option><option value="under">Understated</option><option value="over">Overstated</option></select></p>
                    <div class="text-center"><button class="btn-action" onclick="checkError(2, 'under', 'over', 'over')">Check</button></div>
                    <p id="err-msg-2" class="feedback-msg"></p>
                </div>
            </div>
        </div>
    </div>

    <!-- NEW SLIDE: EQUITY CONCEPT -->
    <div class="slide" id="slide-20">
        <h2>The Bridge: Stockholders' Equity</h2>
        <div class="grid-2">
            <div>
                <p>The <strong>Statement of Stockholders' Equity</strong> acts as a bridge between the Income Statement and the Balance Sheet.</p>
                <div class="card card-highlight mt-4">
                    <h3>Purpose</h3>
                    <p>It details the changes in the owners' claim on the company's assets during the period.</p>
                </div>
            </div>
            <div class="card text-center" style="display:flex; flex-direction:column; justify-content:center; background: #1e293b; color: white;">
                <h3 style="color: white;">The Equity Formula</h3>
                <div style="display: flex; gap: 1rem; justify-content: center; margin-top: 1rem; text-align: left;">
                    <!-- Col 1 -->
                    <div style="background: rgba(255,255,255,0.1); padding: 1.5rem; border-radius: 12px; flex:1;">
                        <h4 style="color: #a78bfa;">Contributed Capital</h4>
                        <div style="color: #e2e8f0;">Beg. Capital</div>
                        <div class="text-success">+ Stock Issuance</div>
                        <div class="text-error">- Repurchases</div>
                        <hr style="border-color: rgba(255,255,255,0.2); margin: 10px 0;">
                        <div style="font-weight:bold;">= End. Capital</div>
                    </div>
                    <!-- Col 2 -->
                    <div style="background: rgba(255,255,255,0.1); padding: 1.5rem; border-radius: 12px; flex:1;">
                        <h4 style="color: #a78bfa;">Retained Earnings</h4>
                        <div style="color: #e2e8f0;">Beg. Retained Earnings</div>
                        <div class="text-success">+ Net Income</div>
                        <div class="text-error">- Dividends</div>
                        <hr style="border-color: rgba(255,255,255,0.2); margin: 10px 0;">
                        <div style="font-weight:bold;">= End. Ret. Earnings</div>
                    </div>
                </div>
                <div style="margin-top: 1.5rem; font-weight: 800; font-size: 1.2rem; background: var(--gradient-primary); padding: 10px; border-radius: 50px;">
                    End. Capital + End. RE = Total Ending Equity
                </div>
            </div>
        </div>
    </div>

    <!-- NEW: STOCKHOLDERS EQUITY -->
    <div class="slide" id="slide-21">
        <h2>Statement of Stockholders' Equity</h2>
        <p>This statement explains the changes in equity during the year.</p>
        
        <div class="grid-2">
            <div>
                <table class="financial-table">
                    <tr><th colspan="2">Apple Inc. - Stockholders' Equity (2022)</th></tr>
                    <tr><td colspan="2" style="background: #f1f5f9; font-weight:bold;">Common Stock & Paid-in Capital</td></tr>
                    <tr><td>Beginning Balance</td><td>$57,365</td></tr>
                    <tr><td style="color: var(--success); font-weight: bold;">Issuance of Stock</td><td style="color: var(--success); font-weight: bold;">+ 7,484</td></tr>
                    <tr class="total-row"><td>Ending Balance</td><td>$64,849</td></tr>
                    
                    <tr><td colspan="2" style="background: #f1f5f9; font-weight:bold;">Retained Earnings</td></tr>
                    <tr><td>Beginning Balance</td><td>$5,562</td></tr>
                    <tr><td style="color: var(--success); font-weight: bold;">Net Income</td><td style="color: var(--success); font-weight: bold;">+ 99,803</td></tr>
                    <tr><td style="color: var(--error); font-weight: bold;">Dividends</td><td style="color: var(--error); font-weight: bold;">(14,793)</td></tr>
                    <tr><td style="color: var(--error); font-weight: bold;">Stock Repurchase</td><td style="color: var(--error); font-weight: bold;">(90,186)</td></tr>
                    <tr class="total-row"><td>Ending Balance</td><td>$396</td></tr>
                </table>
            </div>

            <div class="flex-center">
                <!-- CALCULATOR UI -->
                <div class="calc-ui">
                    <div class="calc-screen" id="calc-display">0</div>
                    <div class="calc-input-row" onclick="addToCalc(5562)">
                        <span>Beg RE:</span> <span>$5,562</span>
                    </div>
                    <div class="calc-input-row text-success" onclick="addToCalc(99803)">
                        <span>+ Net Income:</span> <span>$99,803</span>
                    </div>
                    <div class="calc-input-row text-error" onclick="addToCalc(-14793)">
                        <span>- Dividends:</span> <span>($14,793)</span>
                    </div>
                    <div class="calc-input-row text-error" onclick="addToCalc(-90186)">
                        <span>- Buybacks:</span> <span>($90,186)</span>
                    </div>
                    <div class="calc-input-row" onclick="addToCalc(-3454)">
                        <span>Other Adj:</span> <span>($3,454)</span>
                    </div>
                    <div style="text-align: center; margin: 5px 0;">
                        <button onclick="clearCalc()" style="background: var(--error); border:none; color:white; padding: 4px 15px; border-radius: 20px; cursor: pointer; font-weight: bold;">Clear C</button>
                    </div>
                    <div style="margin-top: 15px; border-top: 1px solid #475569; padding-top: 15px;">
                        <input type="number" id="calc-re-input" placeholder="Enter Result" style="width: 100%; padding: 10px; border-radius: 8px; border: none; font-size:1.1rem; font-weight:bold; text-align:center;">
                        <button class="btn-action" style="width: 100%; margin-top: 10px;" onclick="checkEquity()">Check Answer</button>
                    </div>
                    <p id="equity-msg" class="feedback-msg"></p>
                </div>
            </div>
        </div>
    </div>

    <!-- NEW: FSET TO STATEMENTS -->
    <div class="slide" id="slide-22">
        <h2>Connecting FSET to Financial Statements</h2>
        <p>How do our FSET columns map to the actual reports?</p>
        <div class="grid-3">
            <div class="card text-center" style="border-top: 8px solid #3b82f6;">
                <div class="icon-circle" style="background: #eff6ff;"><i class="fas fa-camera fa-2x" style="color:#3b82f6;"></i></div>
                <h4>Balance Sheet</h4>
                <p style="font-size: 0.9rem; font-weight:bold; color:#64748b;">(Snapshot)</p>
                <hr style="margin: 15px 0; border:0; border-top:2px dashed #e2e8f0;">
                <ul style="font-size: 1rem; list-style: none; padding:0; text-align:left;">
                    <li style="margin-bottom:8px;"><i class="fas fa-arrow-right text-accent" style="margin-right:8px;"></i> Cash Column</li>
                    <li style="margin-bottom:8px;"><i class="fas fa-arrow-right text-accent" style="margin-right:8px;"></i> NonCash Column <br><small class="text-accent" style="margin-left: 25px;">(Inventory, PPE, Intangibles)</small></li>
                    <li style="margin-bottom:8px;"><i class="fas fa-arrow-right text-accent" style="margin-right:8px;"></i> Liabilities Column</li>
                    <li style="margin-bottom:8px;"><i class="fas fa-arrow-right text-accent" style="margin-right:8px;"></i> Contrib. Cap Column</li>
                    <li style="margin-bottom:8px;"><i class="fas fa-arrow-right text-accent" style="margin-right:8px;"></i> Ending Retained Earnings</li>
                </ul>
            </div>
            <div class="card text-center" style="border-top: 8px solid #10b981;">
                <div class="icon-circle" style="background: #ecfdf5;"><i class="fas fa-video fa-2x" style="color:#10b981;"></i></div>
                <h4>Income Statement</h4>
                <p style="font-size: 0.9rem; font-weight:bold; color:#64748b;">(Period Activity)</p>
                <hr style="margin: 15px 0; border:0; border-top:2px dashed #e2e8f0;">
                <ul style="font-size: 1rem; list-style: none; padding:0; text-align:left;">
                    <li style="margin-bottom:8px;"><i class="fas fa-arrow-right text-success" style="margin-right:8px;"></i> <strong>Revenue</strong> (increases EC)</li>
                    <li style="margin-bottom:8px;"><i class="fas fa-arrow-right text-error" style="margin-right:8px;"></i> <strong>Expenses</strong> (decrease EC)</li>
                    <li style="margin-top: 15px; font-weight: bold; background:#f1f5f9; padding:5px; border-radius:5px; text-align:center;">= Net Income</li>
                </ul>
            </div>
            <div class="card text-center" style="border-top: 8px solid #f43f5e;">
                <div class="icon-circle" style="background: #fff1f2;"><i class="fas fa-water fa-2x" style="color:#f43f5e;"></i></div>
                <h4>Statement of Cash Flows</h4>
                <p style="font-size: 0.9rem; font-weight:bold; color:#64748b;">(Change in Cash)</p>
                <hr style="margin: 15px 0; border:0; border-top:2px dashed #e2e8f0;">
                <ul style="font-size: 1rem; list-style: none; padding:0; text-align:left;">
                    <li style="margin-bottom:8px;"><i class="fas fa-arrow-right" style="color:#f43f5e; margin-right:8px;"></i> Sum of all changes in the <strong>Cash Column</strong>.</li>
                    <li style="margin-bottom:8px;"><i class="fas fa-arrow-right" style="color:#f43f5e; margin-right:8px;"></i> Classified into Operating, Investing, Financing.</li>
                </ul>
            </div>
        </div>
    </div>

    <!-- ACT 5: CASH & CLOSING -->
    <div class="slide" id="slide-23">
        <h2>Drag & Drop Challenge</h2>
        <div style="display: flex; gap: 20px; height: 350px; margin-top: 20px;">
            <div id="source" style="flex:1; background: #e2e8f0; padding: 15px; border-radius: var(--radius-lg); overflow-y: auto;">
                <div class="card draggable" draggable="true" id="d1" data-cat="ops" style="padding:15px; margin-bottom:10px; height: auto;">Pay Wages</div>
                <div class="card draggable" draggable="true" id="d2" data-cat="fin" style="padding:15px; margin-bottom:10px; height: auto;">Pay Dividends</div>
                <div class="card draggable" draggable="true" id="d3" data-cat="inv" style="padding:15px; margin-bottom:10px; height: auto;">Buy Factory</div>
                <div class="card draggable" draggable="true" id="d4" data-cat="fin" style="padding:15px; margin-bottom:10px; height: auto;">Issue Stock</div>
                <div class="card draggable" draggable="true" id="d5" data-cat="ops" style="padding:15px; margin-bottom:10px; height: auto;">Collect Cash from Customers</div>
                <div class="card draggable" draggable="true" id="d6" data-cat="inv" style="padding:15px; margin-bottom:10px; height: auto;">Sell Old Truck</div>
            </div>
            <div style="flex:2; display: flex; gap: 15px;">
                <div class="dropzone" data-cat="ops" style="flex:1; padding-top: 20px;"><h5>Operating</h5></div>
                <div class="dropzone" data-cat="inv" style="flex:1; padding-top: 20px;"><h5>Investing</h5></div>
                <div class="dropzone" data-cat="fin" style="flex:1; padding-top: 20px;"><h5>Financing</h5></div>
            </div>
        </div>
        <p id="dnd-msg" class="text-center mt-4 feedback-msg"></p>
    </div>

    <!-- NEW SLIDE: PERM VS TEMP CONCEPT -->
    <div class="slide" id="slide-24">
        <h2>The Accounting Cycle: A Car Analogy</h2>
        <div class="grid-2">
            <div class="card">
                <h3>Trip Meter vs. Odometer</h3>
                <p>Imagine your car's dashboard.</p>
                <ul class="mt-4" style="list-style:none;">
                    <li style="margin-bottom: 20px;">
                        <i class="fas fa-map-marker-alt text-error fa-2x" style="float:left; margin-right: 15px;"></i>
                        <strong>Trip Meter (Income Statement):</strong> Measures distance for <em>one trip</em>. You hit reset (close the books) at the end of the trip so you can measure the next one from zero.
                    </li>
                    <li style="margin-bottom: 20px;">
                        <i class="fas fa-car text-accent fa-2x" style="float:left; margin-right: 15px;"></i>
                        <strong>Odometer (Balance Sheet):</strong> Measures <em>total cumulative</em> distance driven since the car was built. It never resets; it just keeps adding up.
                    </li>
                </ul>
            </div>
            <div class="card text-center flex-center" style="background: var(--gradient-primary); color: white;">
                <div>
                    <i class="fas fa-tachometer-alt fa-6x" style="color: white; margin-bottom: 20px;"></i>
                    <h4 style="color: white; font-size: 2rem;">Closing Process</h4>
                    <p style="color: rgba(255,255,255,0.9); font-weight: bold;">Like pressing the reset button on your trip meter.</p>
                </div>
            </div>
        </div>
    </div>

    <!-- TEMP VS PERM DRILL -->
    <div class="slide" id="slide-25">
        <h2>Permanent vs Temporary Accounts</h2>
        <div class="flip-grid">
            <!-- Perm -->
            <div class="flip-card" onclick="this.classList.toggle('flipped')">
                <div class="flip-inner">
                    <div class="flip-front">
                        <i class="fas fa-lock fa-3x" style="margin-bottom: 20px;"></i>
                        <h3>Which accounts are Permanent?</h3>
                        <p style="font-weight: 600;">(Click to Reveal)</p>
                    </div>
                    <div class="flip-back">
                        <h3 style="color: var(--accent-blue);">Balance Sheet Accounts</h3>
                        <p style="font-weight: bold; font-size: 1.3rem;">Assets, Liabilities, Equity.</p>
                        <p style="background: #f1f5f9; padding: 10px 20px; border-radius: 50px; display:inline-block; font-weight:bold;">Like the Odometer.</p>
                    </div>
                </div>
            </div>
            <!-- Temp -->
             <div class="flip-card" onclick="this.classList.toggle('flipped')">
                <div class="flip-inner">
                    <div class="flip-front" style="background: var(--gradient-fun);">
                        <i class="fas fa-history fa-3x" style="margin-bottom: 20px;"></i>
                        <h3>Which accounts are Temporary?</h3>
                        <p style="font-weight: 600;">(Click to Reveal)</p>
                    </div>
                    <div class="flip-back" style="border-color: var(--error);">
                        <h3 style="color: var(--error);">Income Statement Accounts</h3>
                        <p style="font-weight: bold; font-size: 1.3rem;">Revenue, Expenses, Dividends.</p>
                        <p style="background: #fff1f2; padding: 10px 20px; border-radius: 50px; display:inline-block; font-weight:bold;">Like the Trip Meter.</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="slide" id="slide-26">
        <h2>Closing the Books: The Cycle Completes</h2>
        <p>Watch how temporary accounts (Revenue, Expense, Dividends) are reset to zero and transferred to Retained Earnings.</p>
        
        <div style="display:flex; justify-content:center; gap:15px; margin-bottom:20px;">
            <button class="btn-action" onclick="closingStep(1)" id="btn-close-1">1. Close Revenue</button>
            <button class="btn-action" onclick="closingStep(2)" id="btn-close-2" disabled>2. Close Expense</button>
            <button class="btn-action" onclick="closingStep(3)" id="btn-close-3" disabled>3. Close Dividends</button>
            <button class="btn-action" onclick="resetClosing()" style="background:#94a3b8"><i class="fas fa-undo"></i> Reset</button>
        </div>

        <div class="t-account-grid">
            <!-- Revenue -->
            <div class="t-account-wrapper">
                <h4 class="text-center">Revenue</h4>
                <div class="t-account-visual">
                    <div class="t-left" id="rev-left"></div> <!-- Closing Entry -->
                    <div class="t-right" id="rev-right">100</div> <!-- Beg Bal -->
                </div>
                <div class="text-center mt-2" id="rev-bal" style="font-weight: bold;">Bal: 100</div>
            </div>

            <!-- Retained Earnings -->
            <div class="t-account-wrapper main-account">
                <h4 class="text-center" style="color:var(--accent-blue)">Retained Earnings</h4>
                <div class="t-account-visual">
                    <div class="t-left">
                        <div id="re-left-exp"></div>
                        <div id="re-left-div"></div>
                    </div>
                    <div class="t-right">
                        <div style="border-bottom:2px dashed #cbd5e1; margin-bottom:5px; padding-bottom: 5px;">0 (Beg)</div>
                        <div id="re-right-rev"></div>
                    </div>
                </div>
                <div class="text-center mt-2" id="re-bal" style="font-weight:bold; color:var(--accent-blue); font-size:1.2rem;">Bal: 0</div>
            </div>

            <!-- Expenses -->
            <div class="t-account-wrapper">
                <h4 class="text-center">Expenses</h4>
                <div class="t-account-visual">
                    <div class="t-left" id="exp-left" style="color: var(--text-color);">80</div> <!-- Beg Bal -->
                    <div class="t-right" id="exp-right"></div> <!-- Closing Entry -->
                </div>
                <div class="text-center mt-2" id="exp-bal" style="font-weight: bold;">Bal: 80</div>
            </div>
            
            <!-- Dividends (Smaller or below) -->
            <div class="t-account-wrapper" style="grid-column: 2;">
                <h4 class="text-center">Dividends</h4>
                <div class="t-account-visual">
                    <div class="t-left" id="div-left" style="color: var(--text-color);">20</div>
                    <div class="t-right" id="div-right"></div>
                </div>
                <div class="text-center mt-2" id="div-bal" style="font-weight: bold;">Bal: 20</div>
            </div>
        </div>
        
        <div id="closing-feedback" class="text-center mt-4 feedback-msg"></div>
        <p class="text-center text-error mt-2" style="background: #fff1f2; padding: 10px; border-radius: 8px; display: inline-block; margin: 10px auto 0 auto;"><strong>Note:</strong> Dividends also reduce Retained Earnings directly (Debit RE, Credit Dividends).</p>
    </div>

    <!-- FINAL EXAM -->
    <div class="slide" id="slide-27">
        <h2 class="text-center" style="border:none; width:100%;"><i class="fas fa-award text-accent" style="margin-right: 10px;"></i> Final Exam</h2>
        <p class="text-center">Test your knowledge with these 10 questions. Score 80% to pass.</p>
        <div id="quiz-area" style="max-width: 800px; margin: 2rem auto; background: white; padding: 3rem; border-radius: var(--radius-lg); box-shadow: var(--shadow-lg); border: 2px solid #e2e8f0;">
            <!-- Q1 -->
            <div class="quiz-question" id="q1">
                <p>1. Which financial statement reports a company's financial position at a specific point in time?</p>
                <span class="quiz-option" onclick="selectOption(1, 'a')">A) Income Statement</span>
                <span class="quiz-option" onclick="selectOption(1, 'b')">B) Balance Sheet</span>
                <span class="quiz-option" onclick="selectOption(1, 'c')">C) Statement of Cash Flows</span>
            </div>
            <!-- Q2 -->
            <div class="quiz-question" id="q2">
                <p>2. Under Accrual Accounting, when is revenue recorded?</p>
                <span class="quiz-option" onclick="selectOption(2, 'a')">A) When cash is received</span>
                <span class="quiz-option" onclick="selectOption(2, 'b')">B) When the obligation is satisfied</span>
                <span class="quiz-option" onclick="selectOption(2, 'c')">C) At the end of the month</span>
            </div>
            <!-- Q3 -->
            <div class="quiz-question" id="q3">
                <p>3. If Apple sells an iPhone on credit, which accounts are affected?</p>
                <span class="quiz-option" onclick="selectOption(3, 'a')">A) Cash increases, Revenue increases</span>
                <span class="quiz-option" onclick="selectOption(3, 'b')">B) Accounts Receivable increases, Revenue increases</span>
                <span class="quiz-option" onclick="selectOption(3, 'c')">C) Inventory increases, Cash decreases</span>
            </div>
            <!-- Q4 -->
            <div class="quiz-question" id="q4">
                <p>4. Which of the following is a Temporary Account?</p>
                <span class="quiz-option" onclick="selectOption(4, 'a')">A) Retained Earnings</span>
                <span class="quiz-option" onclick="selectOption(4, 'b')">B) Accounts Payable</span>
                <span class="quiz-option" onclick="selectOption(4, 'c')">C) Cost of Goods Sold Expense</span>
            </div>
            <!-- Q5 -->
            <div class="quiz-question" id="q5">
                <p>5. Paying dividends is classified as which type of Cash Flow?</p>
                <span class="quiz-option" onclick="selectOption(5, 'a')">A) Operating</span>
                <span class="quiz-option" onclick="selectOption(5, 'b')">B) Investing</span>
                <span class="quiz-option" onclick="selectOption(5, 'c')">C) Financing</span>
            </div>
            <!-- Q6 -->
            <div class="quiz-question" id="q6">
                <p>6. Unearned Revenue is classified as:</p>
                <span class="quiz-option" onclick="selectOption(6, 'a')">A) An Asset</span>
                <span class="quiz-option" onclick="selectOption(6, 'b')">B) A Liability</span>
                <span class="quiz-option" onclick="selectOption(6, 'c')">C) Revenue</span>
            </div>
            <!-- Q7 -->
            <div class="quiz-question" id="q7">
                <p>7. Calculate Gross Margin if Revenue is $100 and COGS is $60.</p>
                <span class="quiz-option" onclick="selectOption(7, 'a')">A) $40</span>
                <span class="quiz-option" onclick="selectOption(7, 'b')">B) 40%</span>
                <span class="quiz-option" onclick="selectOption(7, 'c')">C) $160</span>
            </div>
            <!-- Q8 -->
            <div class="quiz-question" id="q8">
                <p>8. An adjustment for Accrued Wages will:</p>
                <span class="quiz-option" onclick="selectOption(8, 'a')">A) Decrease Cash</span>
                <span class="quiz-option" onclick="selectOption(8, 'b')">B) Increase Liabilities (Wages Payable) and Expenses</span>
                <span class="quiz-option" onclick="selectOption(8, 'c')">C) Increase Assets</span>
            </div>
            <!-- Q9 -->
            <div class="quiz-question" id="q9">
                <p>9. Retained Earnings represents:</p>
                <span class="quiz-option" onclick="selectOption(9, 'a')">A) Cash held in the bank</span>
                <span class="quiz-option" onclick="selectOption(9, 'b')">B) Accumulated profits kept in the business</span>
                <span class="quiz-option" onclick="selectOption(9, 'c')">C) Money contributed by shareholders</span>
            </div>
            <!-- Q10 -->
            <div class="quiz-question" id="q10" style="border-bottom: none;">
                <p>10. The fundamental accounting equation is:</p>
                <span class="quiz-option" onclick="selectOption(10, 'a')">A) Assets = Liabilities + Equity</span>
                <span class="quiz-option" onclick="selectOption(10, 'b')">B) Revenue - Expense = Net Income</span>
                <span class="quiz-option" onclick="selectOption(10, 'c')">C) Assets + Liabilities = Equity</span>
            </div>

            <div class="text-center mt-4">
                <button class="btn-action" style="font-size: 1.3rem; padding: 15px 40px;" onclick="gradeQuiz()">Submit Final Exam <i class="fas fa-check-circle" style="margin-left: 8px;"></i></button>
            </div>
            <h2 id="final-score" class="text-center mt-4" style="border:none; font-size: 2.5rem;"></h2>
        </div>
    </div>

    <!-- NAVIGATION BAR -->
    <div id="nav-bar">
        <div style="font-family: var(--header-font); font-weight: 800; font-size: 1.2rem; color: var(--accent-blue);">
            <i class="fas fa-graduation-cap"></i> FinAnalysis Master
        </div>
        <div class="progress-bar-container">
            <div id="progress-fill"></div>
        </div>
        <div style="display: flex; align-items: center;">
            <select id="toc" onchange="jumpToSlide(this.value)"></select>
            <button class="nav-arrow-btn" onclick="prevSlide()"><i class="fas fa-chevron-left"></i></button>
            <span id="slide-indicator" style="margin: 0 15px; font-weight: 700; font-family: 'Fira Code', monospace;">1 / 27</span>
            <button class="nav-arrow-btn" onclick="nextSlide()"><i class="fas fa-chevron-right"></i></button>
        </div>
    </div>

</div>

<script>
    // --- STATE MANAGEMENT ---
    let currentSlide = 0;
    const slides = document.querySelectorAll('.slide');
    const totalSlides = slides.length;

    // --- NAVIGATION ---
    function populateToC() {
        const toc = document.getElementById('toc');
        slides.forEach((slide, index) => {
            const titleEl = slide.querySelector('h1, h2');
            const titleText = titleEl ? titleEl.innerText : `Slide ${index + 1}`;
            const option = document.createElement('option');
            option.value = index;
            option.innerText = `${index + 1}: ${titleText}`;
            toc.appendChild(option);
        });
    }

    function jumpToSlide(index) {
        showSlide(parseInt(index));
    }

    function showSlide(index) {
        if(index < 0) index = 0;
        if(index >= totalSlides) index = totalSlides - 1;
        
        slides[currentSlide].classList.remove('active');
        slides[index].classList.add('active');
        currentSlide = index;
        
        updateNav();
    }

    function nextSlide() { showSlide(currentSlide + 1); }
    function prevSlide() { showSlide(currentSlide - 1); }

    function updateNav() {
        document.getElementById('slide-indicator').textContent = `${currentSlide + 1} / ${totalSlides}`;
        const pct = ((currentSlide + 1) / totalSlides) * 100;
        document.getElementById('progress-fill').style.width = `${pct}%`;
        
        const toc = document.getElementById('toc');
        if (toc) toc.value = currentSlide;
    }

    document.addEventListener('keydown', (e) => {
        if(e.key === 'ArrowRight') nextSlide();
        if(e.key === 'ArrowLeft') prevSlide();
    });

    // --- CALCULATORS ---
    function calcGrossMargin() {
        const rev = parseFloat(document.getElementById('gm-rev').value) || 0;
        const cogs = parseFloat(document.getElementById('gm-cogs').value) || 0;
        const margin = rev - cogs;
        const pct = rev > 0 ? ((margin / rev) * 100).toFixed(1) : 0;
        
        const el = document.getElementById('gm-result');
        el.innerHTML = `$${margin.toLocaleString()} <span class="text-accent" style="margin-left: 10px;">(${pct}%)</span>`;
        el.style.color = margin >= 0 ? 'var(--text-color)' : 'var(--error)';
    }

    // --- FSET SIMULATOR LOGIC ---
    function toggleFSET(btn, dir) {
        const parent = btn.parentElement;
        parent.querySelectorAll('.fset-btn').forEach(b => {
            b.classList.remove('selected-up', 'selected-down');
        });
        if(dir === 'up') btn.classList.add('selected-up');
        if(dir === 'down') btn.classList.add('selected-down');
    }

    function resetFSET(tableId) {
        const table = document.getElementById(tableId);
        const btns = table.querySelectorAll('.fset-btn');
        btns.forEach(btn => btn.classList.remove('selected-up', 'selected-down'));
        // Also find feedback message and clear it
        const feedback = table.parentElement.querySelector('.feedback-msg');
        if(feedback) {
            feedback.textContent = "";
        }
    }

    // Updated checkFSET to handle 2 accounts
    function checkFSET(tableId, correctStates, selectIds, correctAccountVals) {
        const table = document.getElementById(tableId);
        
        // 1. Check Arrows (Movement)
        const activeBtns = table.querySelectorAll('.selected-up, .selected-down');
        let userStates = [];
        activeBtns.forEach(btn => {
            const col = btn.parentElement.dataset.col;
            const dir = btn.classList.contains('selected-up') ? 'up' : 'down';
            userStates.push(`${col}-${dir}`);
        });
        userStates.sort();
        correctStates.sort();
        const arrowsCorrect = JSON.stringify(userStates) === JSON.stringify(correctStates);

        // 2. Check Specific Accounts (Set Matching)
        const userAcct1 = document.getElementById(selectIds[0]).value;
        const userAcct2 = document.getElementById(selectIds[1]).value;
        const userAccts = [userAcct1, userAcct2].sort();
        const correctAccts = correctAccountVals.sort();
        
        const accountsCorrect = JSON.stringify(userAccts) === JSON.stringify(correctAccts);
        
        const feedback = table.nextElementSibling.nextElementSibling.nextElementSibling; // button -> p
        
        if(arrowsCorrect && accountsCorrect) {
            feedback.textContent = "Correct! Balance achieved and correct accounts identified.";
            feedback.style.color = "var(--success)";
        } else if (arrowsCorrect && !accountsCorrect) {
            feedback.textContent = "Equation balanced, but incorrect specific accounts selected.";
            feedback.style.color = "var(--warning)";
        } else {
            feedback.textContent = "Incorrect. Check your arrows and account selections.";
            feedback.style.color = "var(--error)";
        }
    }

    // --- IMPACT OF ERRORS LOGIC ---
    function checkError(id, exp, ast_liab, ni) {
        // IDs: err-1-exp, err-1-ni, err-1-liab
        // Args are correct answers: 'under' or 'over'
        let isCorrect = true;
        
        // Expense Check
        const expVal = document.getElementById(`err-${id}-exp`).value;
        if(expVal !== exp) isCorrect = false;

        // Balance Sheet Item Check
        const bsId = id === 1 ? 'liab' : 'ast';
        const bsVal = document.getElementById(`err-${id}-${bsId}`).value;
        if(bsVal !== ast_liab) isCorrect = false;

        // NI Check
        const niVal = document.getElementById(`err-${id}-ni`).value;
        if(niVal !== ni) isCorrect = false;

        const msg = document.getElementById(`err-msg-${id}`);
        if(isCorrect) {
            msg.textContent = "Correct Analysis!";
            msg.style.color = "var(--success)";
        } else {
            msg.textContent = "Incorrect. Think about the accounting equation.";
            msg.style.color = "var(--error)";
        }
    }

    // --- EQUITY LOGIC & CALCULATOR ---
    // Make the calculator work interactively
    let calcTotal = 0;
    
    function addToCalc(amount) {
        calcTotal += amount;
        document.getElementById('calc-display').innerText = calcTotal.toLocaleString();
    }
    
    function clearCalc() {
        calcTotal = 0;
        document.getElementById('calc-display').innerText = "0";
    }

    function checkEquity() {
        const correct = -3068; 
        const val = parseFloat(document.getElementById('calc-re-input').value.replace(/,/g, '')) || 0;
        const msg = document.getElementById('equity-msg');
        
        // Since input might be confusing with negative, let's accept positive input if they ignore sign or negative.
        if(Math.abs(val - correct) < 500) {
            msg.textContent = "Correct! $(3,068) Million (Deficit due to buybacks)";
            msg.style.color = "var(--success)";
        } else {
            msg.textContent = "Incorrect. Sum the column: 5,562 + 99,803 - 14,793 - 90,186 - 3,454";
            msg.style.color = "var(--error)";
        }
    }

    // --- CLOSING PROCESS LOGIC ---
    function closingStep(step) {
        if(step === 1) {
            // Close Revenue
            document.getElementById('rev-left').innerHTML = "<span style='color:var(--error)'>100</span>";
            document.getElementById('rev-bal').innerText = "Bal: 0";
            
            document.getElementById('re-right-rev').innerHTML = "<span style='color:var(--success)'>100</span> <small>(Rev)</small>";
            document.getElementById('re-bal').innerText = "Bal: 100";
            
            document.getElementById('closing-feedback').innerText = "Revenue closed (to 0). Transferred to increase Retained Earnings.";
            document.getElementById('closing-feedback').style.color = "var(--success)";
            
            document.getElementById('btn-close-1').disabled = true;
            document.getElementById('btn-close-2').disabled = false;
        }
        if(step === 2) {
            // Close Expense
            document.getElementById('exp-right').innerHTML = "<span style='color:var(--error)'>80</span>";
            document.getElementById('exp-bal').innerText = "Bal: 0";
            
            document.getElementById('re-left-exp').innerHTML = "<span style='color:var(--error)'>80</span> <small>(Exp)</small>";
            document.getElementById('re-bal').innerText = "Bal: 20"; // 100 - 80
            
            document.getElementById('closing-feedback').innerText = "Expenses closed (to 0). Transferred to decrease Retained Earnings.";
            document.getElementById('closing-feedback').style.color = "var(--warning)";
            
            document.getElementById('btn-close-2').disabled = true;
            document.getElementById('btn-close-3').disabled = false;
        }
        if(step === 3) {
            // Close Dividends
            document.getElementById('div-right').innerHTML = "<span style='color:var(--error)'>20</span>";
            document.getElementById('div-bal').innerText = "Bal: 0";
            
            document.getElementById('re-left-div').innerHTML = "<span style='color:var(--error)'>20</span> <small>(Div)</small>";
            document.getElementById('re-bal').innerText = "Bal: 0"; // 20 - 20
            
            document.getElementById('closing-feedback').innerHTML = "<strong>Process Complete!</strong> Dividends closed. Ending Retained Earnings is updated.";
            document.getElementById('closing-feedback').style.color = "var(--accent-blue)";
            
            document.getElementById('btn-close-3').disabled = true;
        }
    }

    function resetClosing() {
        document.getElementById('rev-left').innerHTML = "";
        document.getElementById('rev-bal').innerText = "Bal: 100";
        document.getElementById('re-right-rev').innerHTML = "";
        document.getElementById('re-bal').innerText = "Bal: 0";
        document.getElementById('exp-right').innerHTML = "";
        document.getElementById('exp-bal').innerText = "Bal: 80";
        document.getElementById('re-left-exp').innerHTML = "";
        document.getElementById('div-right').innerHTML = "";
        document.getElementById('div-bal').innerText = "Bal: 20";
        document.getElementById('re-left-div').innerHTML = "";
        document.getElementById('closing-feedback').innerText = "";
        
        document.getElementById('btn-close-1').disabled = false;
        document.getElementById('btn-close-2').disabled = true;
        document.getElementById('btn-close-3').disabled = true;
    }

    // --- DRAG AND DROP ---
    const draggables = document.querySelectorAll('.draggable');
    const dropzones = document.querySelectorAll('.dropzone');

    draggables.forEach(d => {
        d.addEventListener('dragstart', () => d.classList.add('dragging'));
        d.addEventListener('dragend', () => d.classList.remove('dragging'));
    });

    dropzones.forEach(zone => {
        zone.addEventListener('dragover', e => {
            e.preventDefault();
            zone.style.background = '#e1f5fe';
            zone.style.borderColor = 'var(--accent-blue)';
        });
        zone.addEventListener('dragleave', () => {
            zone.style.background = 'transparent';
            zone.style.borderColor = '#cbd5e1';
        });
        zone.addEventListener('drop', e => {
            e.preventDefault();
            zone.style.background = 'transparent';
            zone.style.borderColor = '#cbd5e1';
            const draggable = document.querySelector('.dragging');
            const dragCat = draggable.dataset.cat;
            const zoneCat = zone.dataset.cat;
            
            if(dragCat === zoneCat) {
                zone.appendChild(draggable);
                draggable.style.borderLeft = "6px solid var(--success)";
                document.getElementById('dnd-msg').textContent = "Correct Match!";
                document.getElementById('dnd-msg').style.color = "var(--success)";
            } else {
                document.getElementById('dnd-msg').textContent = "Incorrect bucket!";
                document.getElementById('dnd-msg').style.color = "var(--error)";
            }
        });
    });

    // --- FINAL EXAM ---
    let userAnswers = {};
    function selectOption(qNum, option) {
        userAnswers[qNum] = option;
        // Visual selection
        const qDiv = document.getElementById(`q${qNum}`);
        const opts = qDiv.querySelectorAll('.quiz-option');
        opts.forEach(o => o.classList.remove('selected'));
        event.target.classList.add('selected');
    }

    function gradeQuiz() {
        const key = {
            1: 'b', 2: 'b', 3: 'b', 4: 'c', 5: 'c',
            6: 'b', 7: 'a', 8: 'b', 9: 'b', 10: 'a'
        };
        let score = 0;
        for(let i=1; i<=10; i++) {
            const qDiv = document.getElementById(`q${i}`);
            // Reset colors
            qDiv.querySelectorAll('.quiz-option').forEach(o => {
                o.style.background = 'white';
                o.style.borderColor = '#e2e8f0';
            });
            
            if(userAnswers[i] === key[i]) {
                score++;
                // Highlight correct
                const selected = qDiv.querySelector(`.selected`);
                if(selected) {
                    selected.style.background = '#ecfdf5';
                    selected.style.borderColor = 'var(--success)';
                }
            } else {
                 // Highlight wrong if selected
                 if(userAnswers[i]) {
                     const selected = qDiv.querySelector(`.selected`);
                     if(selected) {
                        selected.style.background = '#fff1f2';
                        selected.style.borderColor = 'var(--error)';
                     }
                 }
            }
        }
        
        const pct = (score / 10) * 100;
        const resultEl = document.getElementById('final-score');
        resultEl.innerHTML = `<i class="fas ${pct >= 80 ? 'fa-trophy' : 'fa-times-circle'}" style="margin-right:10px;"></i> You scored ${pct}% (${score}/10)`;
        resultEl.style.color = pct >= 80 ? 'var(--success)' : 'var(--error)';
    }

    // Init
    populateToC();
    updateNav();

</script>
</body>
</html>
